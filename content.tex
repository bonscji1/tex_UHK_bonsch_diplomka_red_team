\section{Úvod}\label{sec:uvod}

% TODO WRITER: text

Zde vysvětlit problémovou situaci a otázky, které se budou v bakalářské/diplomové práci řešit.

\section{Cíl práce}\label{sec:cil-prace}

% TODO WRITER: text

Smysl a účel, výzkumné otázky.

%teoretická část
\section{Metodika zpracování}\label{sec:metodika-zpracovani}

% TODO WRITER: text

Cíle, hypotézy/ výzkumné otázky, způsob hledání odpovědí na výzkumné otázky včetně metodiky vlastního výzkumu/šetření, literární rešerše.

\section{Úvod do problematiky Cyber-security}
%todo writer clean whole text, add as needed
V dnešní době díky rozvoji moderních technologií tráví velká část lidské populace značné množství času interakcemi s těmito technologiemi.
Ať už se jedná o Internet, \firstac{IoT}, mobilní bankovnictví nebo sociální sítě, lidé se na technologií stávají čím dál více závislí.
Technologie nám usnadňují všední život, dovolují práci z domova nebo přináší příležitosti, které jen pár let předem neexistovaly.
Tento rozvoj bohužel není jen kladný.
Rozvoj se projevil i hrozbami, kterým populace čelí.
Některé hrozby, jako malware jsou pro lidstvo nové.
Jiné jsou staré jako lidstvo samo a pouze se novým okolnostem přizpůsobily.
Jedním příkladem za všechny je Sociální inženýrství.

\paragraph{}
Hrozbám nečelí jen samotní lidé ale i firmy a dokonce státy.
Státy na celém světě se staly na kybernetickém světe zcela závislé.\cite{LI20218176}
Jakékoli jeho selhání může ohrozit jejich funkčnost a odvázání se od něj je již nemožné.
Existuje nezměrné množství hrozeb.
Je jasné, že v prostředí kde mezi sebou soupeří státy je značné úsilí věnováno jak zabezpečení tak útoku.
Rozdíly mezi cyber-útokem, cyber-zločinem a cyber-válkou jsou ve většině případů rozděleny pouze dle účastníků.\cite{LI20218176}
Způsob útoku či hrozby na zatřídění do předchozích kategorií klade minimální vliv, zohledněn bývá pouze výsledek.


\section{Relevance}
Relevantnost problematiky cyber-bezpečnosti potvrzuje nejen množství akademických textů které zkoumají tuto problematiku, ale také stále větší zájem všeobecné veřejnosti.
Hlavním důvodem je vzrůstající povědomí populace, způsobené medializací útoků sociálního inženýrství nebo ransomware které populaci v poslední době ovlivňovaly.
V době psaní je v popředí například ransomware útok na dětskou nemocnici SickKids.\cite{bleep_sickkids_ransom}
I když Ransomware skupina \textit{LockBit} poskytla nemocnici \textit{decryptor} zdarma a s omluvou, nemění to nic na vážnosti situace.
Je totiž důležité si uvědomit, že takovýto útok nastal.
Byl schopen omezit optimální funkčnost nemocnice zašifrováním důležitých interních systému.
A bohužel není jediným ransomware útokem zaměřeným na zdravotnictví.
Je tedy možné předpokládat, že nastanou i další útoky na nemocnice.
A příští útok nemusí být veden skupinou, která se řídí silným morálním kompasem.
Důležité je na závěr poznamenat, že tento silný morální kompas platí jen na omezení funkčnosti které může vést ke smrti.
Nevztahuje se na méně kritické instituce nebo ani na prodej již získaných zdravotních dat na černém trhu.

\paragraph{}
Je tedy důležité věnovat se i nadále cyber-bezpečnosti.
Jsou hrozby, které jsou dobře prostudované a víme, jak se jim efektivně bránit.
Jsou hrozby, kterým je sice obtížné se bránit, ale jsou omezené rozsahem a tak je obrana uskutečnitelné.
Ale také jsou hrozby, na které obrana zatím neexistuje.
Tyto hrozby je nutné najít a zkoumat, aby bylo možné ochranu vytvořit.

\subsection{Studie trendů Cyber-security}
Dlouhodobě můžeme v rámci Cyber-security rozeznávat několik klíčových zaměření.
Zajímavé jsou změny v prioritách zaměření v ohledu na čas, které můžeme zkoumat na literatuře.
Velké změny lze zaznamenat především před a po pandemii Covidu-19.\cite{KUMAR2022102821}
Jako i u jiných odvětví můžeme dělit celou sféru na 2 části, část akademickou a část veřejnou.
Je jasné, že zaměření těchto dvou částí budou lehce rozdílná, proto je nutné dívat se na ně odděleně i když se v mnoha ohledech překrývají a ovlivňují.
Důvod proč zkoumáme rozdíl před a po Covidu-19 je rapidní navýšení adopce digitálních technologií, které v této době proběhlo.
Ztížené pracovní podmínky vyžadovaly zavádění nových technologií.
To znamená nová bezpečnostní rizika vzniklá nejen z těchto technologií, ale i z přístupu jejich využívání.
Je značný rozdíl v bezpečnosti práce uživatele, nachází-li se v uzavřené síti uvnitř společnosti nebo při připojování na dálku při práci z domova.

\nlparagraph{Akademická literatura}
V akademické sféře je možné vidět zaměření výzkumu.
Dlouhodobě populárními tématy jsou jsou \textit{cyber risk management, detekce malware} nebo \textit{systémy detekce přístupu}.\cite{KUMAR2022102821}
Tato témata je možné nalézt jak před, tak i po pandemii Covidu-19.
Témata, které byla mnohem více zkoumána před pandemií jsou například využití \textit{Machine learningu}, a to jak pro detekci hrozeb tak hledání nových útočných vektorů.
Také \textit{Blockchain} a \textit{Cryptoměna} jsou témata, která byla před pandemií v oblasti zájmu akademiků mnohem více, nežli po pandemii.\cite{KUMAR2022102821}
Pandemie způsobila velký zvrat v myšlení.
Vedlo to ke zkoumání témat, které bylo nutné okamžitě aplikovat nebo která byla nutné pro budoucí fungování společnosti.
Objevují se zde mnohem více témata zaměřená na \textit{Zdravotnictví, Bankovní sektor} nebo \textit{zranitelnosti dodavatelského řetězce}.\cite{KUMAR2022102821}
Všechna tato témata mají jasný vznik v okolnostech pandemie a jejich zkoumání je prováděno i roky po pandemii samotné.

\nlparagraph{Všeobecná literatura}
Všeobecná literatura poukazuje na zájmy a zvědavost lidu, proto zde lze odvodit zaměření ale také problémy populace.
Před pandemií byly nejčastější témata zaměřená na \textit{finančně zaměřené kybernetické útoky}.
Ty spolu s běžnými tématy jako \textit{běžné bezpečnostní slabiny, úniky dat} a \textit{malware incidenty} vzbuzovaly největší zájem médií.\cite{KUMAR2022102821}
Pandemie rapidně změnila zájem lidu.
Zaměření se přesunulo na útoky, které se během pandemie značně rozšířily.
Jsou jimi hlavně \textit{Sociální inženýrství} nebo útoky \textit{ransomware}.
Také útoky na \textit{Zdravotnictví} byli mnohem častěji reportovány medii.
Tématem, které je v obou obdobích významné je \textit{malware}.
Jeho primární zaměření se však liší.
Před pandemií byla literatura zaměřena hlavně na ovlivnění správného chodu firem.
Po pandemii se psalo spíše o dopadech na digitální infrastrukturu jako jsou \textit{služby v cloudu}.

\nlparagraph{Současné trendy}
V současných trendech však dominuje konflikt na Ukrajině.
Je známé, že Rusko provádělo přípravu roky před samotným vypuknutím války na Ukrajině.
Zdroje poukazují na incidenty již v roce 2014\cite{russian_cyber_usage}.
Asi nejničivějším je však NotPetya z roku 2017\cite{NotPetya}
Faktem také je, že Rusko se nikdy neostýchalo využívat cyber útoky ve svůj prospěch.
Naopak, jejich používání je často těžkopádné a dalo by se říci i nezodpovědné.
Příkladem je útok zaměřený na olympijské hry ve městě Tokyo\cite{Tokyo_olympic_attack}.
Není tak překvapením zaznamenání hned několika cyber útoků před samotným vypuknutím války\cite{before_ukranian_war_attacks}.
Zajímavé jsou však hlavně markantní změny, které nastaly po samotném vypuknutí konfliktu a jejich vliv na bezpečnost do budoucna.
Možná nejlepším průvodcem těmito změnami je každoroční report vydávaný \firstac{ENISA}\cite{Enisa_thread_landscape}.
Z tohoto reportu jsou snadno rozpoznatelné hlavní trendy, stačí zohlednit celkové rozdělení reportu.
Hlavními zájmy jsou \textit{Ransomware ,Malware, Sociální Inženýrství, Hrozby pro data,	Hrozby pro dostupnost, Dezinformace a Supply-chain útoky}.
Samotné hrozby jsou blíže vysvětleny v následujících kapitolách.
Důležité je poukázat na trendů útoku na supply-chain a dezinformace.
Nelze říci, že tyto útoky byly v předchozích letech neexistující, v porovnání se současnou situací to tak ale téměř vypadá.
Jejich závažnost a také množství rapidně vzrostlo.
Není tak divu, že se objevují na listu hlavních hrozeb.
~\clfig{ENISA_prime_threats}{\linewidth}{Primární hrozby identifikované agenturou ENISA}{\cite{Enisa_thread_landscape}}{fig:PrimeThreats}

\nlparagraph{Pegasus spyware}
Speciální zmínku si zaslouží Pegasus spyware a celkově průmysl špehování na zakázku.
Za zrodem Pegasus spyware stojí Izraelské společnost NSO Group.
Pegasus je využíván pro špehování, překvapivě jsou však cílovým zákazníkem státní instituce a totalitní režimy.
Průmysl špehování na zakázku funguje celosvětově a zaměřuje se stále více na běžné uživatele internetu.
Cílem je nejen zisk informací ale také manipulace cílů za účelem kompromitování jejich zařízení a účtů.
Většina zprostředkovatelů těchto služeb tvrdí, že služby jsou určené pro sledování zločinců a teroristů.
Tomuto tvrzení však jednoznačně protiřečí výzkum provedený společností \ac{ENISA}.
Více než 30,000 aktivistů za lidská práva, novinářů a právníků po celém světě bylo cílem špehování.
V Evropě byl hlášen vysoký počet případů právě se špionážním softwarem Pegasus od NSO\@.
Například byli monitorováni politici Španělska a vůdci katalánské nezávislosti.
Navíc sama skupina NSO uvedla, že pět států \firstac{EU} používá jejich špionážní software Pegasus.\cite{Enisa_thread_landscape}

\nlparagraph{Další entity v průmyslu špehování na zakázku}
~\clfig{Facebook_banned_entities}{\linewidth}{Entity identifikované společností Meta}{\cite{pegasus_facebook}}{fig:FacebookThreads}
Facebook je jeden ze zdrojů informací, které se používají pro špehování.
Meta se snaží tuto činnost zredukovat a tak provedla kroky proti 7 různým entitám operujícím špehování na zakázku.
Tyto entity sídlily působícím z Číny, Izraele, Indie a Severní Makedonie.
Entity zaměřovaly svoje působení na lidi ve více než 100 zemích po celém světě.
Obrázek ~\ref{fig:FacebookThreads} ukazuje ovlivněné entity.
Také je vidět, na kterých částech řetězce sledovací operace se jednotlivé entity podílely.
Řetězec se skládá z \textit{průzkumu}, \textit{navázání kontaktu} a \textit{využití}.
\textit{Průzkum} je první fáze řetězce sledování.
Obvykle je nejhůře zaznamenatelná.
Cíl sledování je potichu profilován s využitím software k automatickému sběru dat z celého internetu.
Informace o cíli pochází ze všech dostupných online zdrojů, a to jak volně dostupných tak i placených nebo nelegálních.
Jsou to data z veřejných webů, jako jsou blogy nebo sociální média.
Dále data z platforem pro správu znalostí, jako je například Wikipedia.
V neposlední řadě jsou data sbírána z `dark web' stránek, kde lze naleznout výpisy z napadených databází.
\textit{Navázání kontaktu} je druhá fáze řetězce.
Typicky je právě zde největší možnost odhalit sledování a s ním spojený útok.
Obezřetnost je tedy opět nejdůležitější krok k předcházení hrozeb.
tato část řetězce je zaměřena na navázání kontaktu s cíli nebo lidmi v jejich blízkosti.
Primárním cílem je vybudovat s cílem důvěru, získat nebo ověřit informace z předchozího kroku a v neposlední řadě připravit cíl na třetí fázi řetězce.
Za tímto účelem jsou zde využívány taktiky sociálního inženýrství.
Používají se fiktivní nebo ukradené identity aby oslovili lidi prostřednictvím e-mailů, telefonních hovorů, textových zpráv nebo zpráv na sociálních médiích.
\textit{Využitím} se myslí manipulace cíle.
Tato poslední část řetězce sledování obnáší vytváření phishingových domén, které jsou navržené tak, aby cíle oklamaly.
domený se snaží získat od cíle informace noho ho přesvědčit k provedení akce, která není v jeho nejlepším zájmu.
Jako cenné informace jsou brány přihlašovací údaje, například k  e-mailovému účtu, sociálním médiím, finančním službám nebo do  firemní sítě.
za nežádoucí akce se považuje instalace malware, specificky spyware pro další zisk informací nebo ransomware pro peněžitý zisk.\cite{pegasus_facebook}

\nlparagraph{Nejvíce napadené odvětví}
~\clfig{ENISA_targeted_sectors}{\linewidth}{Nejvíce napadené sektory (v období červenec 2021 - červen 2022)}{\cite{Enisa_thread_landscape}}{fig:TargetedSectors}
Z již zmíněného reportu\cite{Enisa_thread_landscape} je možné vyčíst, ve kterých odvětvích je zaznamenáno nejvíce útoků.
Útoky jsou jen zřídka omezené na jeden sektor, ve většině případů i útok zaměřený na specifický sektor přetéká díky provázanosti do ostatních.
Tento pohled na sektory je i přesto důležitý právě kvůli připravenosti jednotlivých sektorů na útoky.
Můžeme očekávat, že sektor zabývající se zprostředkováním digitálních služeb bude mít jinak připravenou ochranu než například vládní sektor.
A to nejen díky primárnímu zaměření sektoru ale také dopadu úspěšných útoků v minulosti a předvídaném dopadu budoucích útoků.
Na první pohled je z ~\ref{fig:TargetedSectors} vidět, že téměř čtvrtina útoků byla zaznamenána ve vládním sektoru.
Kolem 13 procent pak spadá jak sektoru zprostředkování digitálních služeb tak veřejnosti.
Lze očekávat, že množství útoků v těchto sektorech je ovlivněné dopadem, snadností propagace útoku a v případě veřejnosti taky celkovému množství možných cílů.
Zajímavá je také poznámka v reportu týkající se sektorů bankovnictví a zdravotnictví.
V době sledování byly tyto sektory napadané konzistentně v rámci celé sledované periody.
Zajímavý, hlavně v kontextu wálky na Ukrajině, je také armádní sektor, kde je zaznamenáno kolem 3 procent útoků.
Tato nízká procentní reprezentace by mohla být způsobena metodologií sestavování tohoto reportu.
Útoky byly zaznamenávány pomocí \firstac{OSINT}, neboli volně dostupných informací\cite{moje_bakalarka}.
Volně dostupné informace mají mnohá omezení.
Je jich velké množství a proto je nutné užitečná data dolovat.
Jen málokdy je na první pohled zřejmé, která informace je užitečná.
Hlavním problémem v tomto případě je však jejich vznik.
Volné informace jsou volné protože je tvůrce volně zpřístupnil široké veřejnosti.
I když společnosti začínají být zodpovědnější v nahlašování útoků, stále lze předpokládat že některé byly přehlédnuty nebo nenahlášeny.
Ve vojenském sektoru bude limitace informací prioritou.
Proto bude v kombinaci s propagandou obou stran konfliktu a limitací nežádoucích informací velmi obtížné sestavovat jakoukoli přesnou reprezentaci útoků.

\section{Nejčastější cyber-útoky}
Mezi nejčastější útoky dlouhodobě patří \textit{denial-of-service}, \textit{man-in-the-middle}, \textit{malware} a samozřejmě \textit{sociální inženýrství}\cite{LI20218176}.
Také zaznamenané útoky v roce 2022 jsou v souladu s tímto trendem.
Jsou to však velmi obecné kategorie, kde se specifika velmi liší.
Například pod malware se řadí již zmíněný spyware ale také ransomware, adware, rootkits, etc.
Pouze použití ransomware v roce 2022 vzrostlo o 41\%, primárně v první polovině roku.
Také čas na odhalení a nápravů úspěšného útoku trval o 49 dní déle, než bylo běžné.
V kategorii sociální inženýrství převládá phishing.
Ten je stále nejčastějším útokem.
Jeho oblíbenost spočívá v jeho efektivitě a relativně nízkých nákladech na provedení.
Počet zaznamenaných útoků téměř každoročně stoupá\cite{moje_bakalarka}.
Není tak divu, že jen za první polovinu roku 2022 byl zaznamenán nárůst v četnosti útoků o 48\%.
V této době bylo nahlášeno přes 11 tisíc útoků které stály cíle 12.3 milionů dolarů.
Je nutné poznamenat, že statistiky se týkají pouze \textit{zaznamenaných} útoků.
Mnoho společností tyto útoky veřejně neoznamuje.
Může tomu být z pokusu zachování dobré pověsti.
Horší možnost je že útok nezaznamenali.\cite{securityintelligence_most_common_2022_attacks}

\nlparagraph{Nové cíle}
Stále více útoků se zaměřuje na \textit{Supply-chain} a \ac{IoT}.
To nemůže být překvapením.
Již v předchozích letech bylo možné zaznamenat neklid mezi ruskem a ukrajinou.
Plné vypuknutí války samozřejmě zahrnuje útoky na infrastrukturu, a to i v online prostředí.
\textit{Supply-chain} je výborným cílem ze dvou důvodů.
Úspěšný útok v jedné části řetězce dovoluje šířit se po celku a dopad úspěšného útoku je proto významný.
Výzkumná zpráva od Accenture\cite{accenture_supply-chain-disruption} odhadla škody způsobené v Eurozóně těmito útoky na 112.7 bilionů euro.
Odhad na období 2022/2023 spojený právě s várkou je 242 bilionů euro a v nejhorším případě až 920 bilionů.
Také útoky na \ac{IoT} zařízení stoupají.
Není tomu však díky zvýšené oblíbenosti u útočníků nebo lepších metodách útoku.
Zvýšení plyne téměř čistě ze zvyšujícího množství zařízení.
\ac{IoT} zařízení jsou používána všude, najdeme je v domácnostech, firmách, továrnách nebo kasinech.
Tato zařízení ulehčují lidský život, bohužel jsou také novým rizikem.
Obzvláště protože jejich zabezpečení není priorita při vývoji těchto zařízení.
Proto jsou cílem útočníku at už jako přídavek do botnetu nebo jako slabý článek obrany samotné.
Zní opravdu špatně když se povede útočníkům ukrást důvěrné informace z kasína pomocí chytrého thermometeru akvária\cite{casino_thermometer}.
O vážnosti situace svědčí i veřejná prohlášení o slabinách, která vydávají přímo státy.
Například pro monitorovací zařízení vozidel MiCODUS MV720 toto prohlášení vydala americká vláda\cite{america_gov_advisories_micodus}.
A není divu, toto zařízení nejen monitoruje vozidlo ale je i schopné odpojit přívod paliva.
Jelikož je toto zařízení nachází hlavně v armádní a policejní technice, je to opravdu velký problém.\cite{securityintelligence_most_common_2022_attacks}

\nlparagraph{Zdroje nejčastějších útoků}
Právě z těchto důvodů je nutné podívat se nejčastější kategorie útoků.
V předchozím textu byly mnohé zmíněny, následuje jejich rozbor do hloubky.
Kategorie byly zvoleny z kombinaci několika zdrojů, jako je \ac{ENISA}\cite{Enisa_thread_landscape}, Cisco\cite{cisco_most_common_attack} nebo \firstac{NIST}\cite{nist_risks}.

\subsection{Malware}
Tento termín se používá pro škodlivý software.
Zahrnuje známé hrozby jako viry, červy, trojské koně, spyware a ransomware.
Do systému se dostávají pomocí jeho slabin, často díky nepozornosti uživatele.\cite{cisco_most_common_attack}
Malware je důvod, proč si uživatele musí dávat pozor na jaké linky klikají a jaké programy instalují.
Je také nutné dávat si pozor odkud je program stažen.
Stále častěji malware předstírá, že je legitimní software.
Mezi nejznámější napodobované programy patří Skype, Adobe Acrobat, VLC nebo 7zip.\cite{virustotal_report_findings}
Škodlivému software se bohužel nevyhnul ani státní sektor.
Není však jen jeho cílem ale je také používán k šíření.
Zkoumání z roku 2022 ukazuje, že je možné najít desítky instancí hostování škodlivého software přímo v doménách spojených se státními institucemi.\cite{virustotal_report_findings_goverment}
Tento problém není specifický pro jeden stát ale je to celosvětový problém, jak je možné vidět na ~\ref{fig:MaliciousGoverments}.
Státní stránky nejsou blokované, naopak k nim existuje implicitní důvěra.
Proto je tento problém opravdu závažný.
~\clfig{malicious_govs_domains}{\linewidth}{Zneužití státní infrastruktury}{\cite{virustotal_report_findings_goverment}}{fig:MaliciousGoverments}

\nlparagraph{Obrana a detekce}
Obrana proti malware je složitá.
Nelze totiž ukázat na jednu specifickou chybu, kterou je nutné opravit aby tento problém nenastal znovu.
Existují však dobré uživatelské praktiky, které riziko infikování stroje malware snižují.
Absolutním základem je aktualizování softwaru používaného zařízení.
Mnoho velkých firem aktivně sleduje bezpečnostní incidenty spojené s jejich zařízeními a snaží se své uživatele chránit pomocí bezpečnostních aktualizací.
Pro detekci malware je vhodný antivirus, který je schopný z online databází nalézt nejznámější rysy malware kampaní a ty pak detekovat v nainstalovaných souborech.
Pokud nastane podezření na malware, je proto dobré pomocí antiviry zkontrolovat soubory.
Podezření by mělo nastat při výrazném zpomalení zařízení, nemožnosti vypínat programy, vyskakování reklam nebo cizích pokusech o přihlášení k osobním účtům.
Aby se předešlo samotné instalaci malware, je nutné dbát na bezpečné chování uživatele co se týče procházení internetu, instalace programů a klikání na soubory nebo odkazy v emailech.
Jak již bylo zmíněno, malware může být zabalen společně s legitimním software, je proto velmi důležité instalovat programy pouze z ověřených, ideálně oficiálních zdrojů.
Pozor na stránky, které napodobují oficiální stránky daného produktu.
Na nich lze malware očekávat s jistotou.
Nutné je také dávat pozor na podezřelé odkazy nebo soubory v emaily.
I přes tyto vektory se do zařízení může dostat malware.
V poslední řadě je nutné zmínit USB zařízení.
Pokud je to možné, uživatel by neměl nikdy zapojovat ke svému zařízení neznámé usb zařízení.
Ty jsou totiž nejen hrozba v podobě přenašeče malware ale dokonce i hrozba samotnému zařízení.
Příkladem takto nebezpečného zařízení je USBKill\cite{usb_kill}.
Toto zařízení na testování hardwaru se při napojení do usb portu nabije a pak vypustí svůj náboj zpět do portu.
Novější verze jsou dokonce schopné nabití dopředu.
To znamená, že jsou schopna útočit na vypnutá zařízení a obchází všechny známé bezpečnostní protokoly.

\subsubsection{Ransomware}
Za zvláštní zmínku stojí ransomware, jelikož je to velmi nebezpečný a útočníky oblíbený malware.
Jedná se o typ útoku, kdy útočníci přebírají kontrolu nad cílovými daty a požadují výkupné výměnou za obnovení dostupnosti těchto dat nebo zachování tajnosti dat.
Útočníci tak přímo ohrožují dostupnost, důvěrnost i integritu dat.
Jednoduché ransomware útoky data pouze odcizí a vyhrožují vypuštěním, popřípadě uzamknou systém, aby nebylo možné se k datům dostat.
Nejčastější jsou však sofistikované ransomware útoky, kde jsou data zašifrována a klič nebo dokonce program pro jejich odšifrování je oběti poskytnut až po zaplacení výkupného.
Ve výjimečných případech se stává, že klíč k odšifrování dat není poskytnut nikdy.
Důvod proč jsou tyto situace výjimečné je však zřejmý.
Není to dobré pro business ransomware skupin.
Nejen že neposkytování klíčů by vedlo k neplacení výkupného ale také to snižuje okruh cílů.
Zašifrovaná data totiž nemá cenu znovu napadat a žádat o další výkupné.
Tyto myšlenkové pochody útočníků nemůžou být překvapením.
Z interních dokumentů a logů skupiny Conti je zřejmé, že alespoň některé ransomware skupiny operují jako běžná společnost\cite{Conti_logs}.
Ve skupině pracovali manažeři, útočníci pracovali převážně během pracovního týdne a dokonce měli nárok na placenou dovolenou a jiné benefity.
K rozšíření tohoto typy útoku přispívá také koncept \ac{RaaS}.
Ten dovoluje i nezkušeným útočníkům operovat s velice sofistikovaným software.
Naopak zkušení útočníci nemusí ztrácet čas hledáním cílů ale soustředí se pouze na vyvíjení ransomware nástrojů a technickou podporu.
Z každého úspěšně provedeného útoku jim totiž náleží část peněz.\cite{Enisa_thread_landscape}


\nlparagraph{Monitorování}
~\clfig{ENISA_Ransomware}{\linewidth}{Počet zaznamenaných Ransomware incidentů a velikost ukradených dat ve sledovaném období květen 2021 až červen 2022}{\cite{Enisa_thread_landscape}}{fig:ENISA_Ransomware}
Jak je vidět z ~\ref{fig:ENISA_Ransomware}, Ransomware útoky byly v době sledování, tedy období od Května 2021 do červen 2022, časté a dopad na data byl značný.
Sledování těchto útoků je však velmi obtížné.
Pokud dochází pouze k vydírání, firmy mohou výkupné zaplatit a pokusit se zamlčet existenci útoku.
Se stoupajícími částkami výkupného je tato možnost stále méně validní.
Spíše se firmy obrací na pojištění proti ransomware.
To však ironicky zvyšuje jejich atraktivnost jako cíl, protože je jistota zaplacení výkupného
Dalším problémem monitorování je abstrakce ze strany útočníka.
Pro zmatení vyšetřovatelů nejsou pro ransomware skupiny neobvyklé změny názvu spolu s falešným odchodem do důchodu.
Tato stejná skupina pak se změněným jménem operuje nadále, můžou však pozměnit styl provádění útoků nebo nástroje.
Díky rivalitě mezi skupinami často dochází ke kradení zdrojových kódy, což však znesnadňuje identifikování této skupiny se skupinou původní.
Častým vodítkem bývají adresy krypto peněženek.
Výplaty výkupného v jsou vždy v kryptoměně, například Bitcoinu.
To samozřejmě také ztěžuje vystopování a trestní stíhání pachatelů.
Bez nadsázky lze říci, že monitorování ransomware skupin je složitější než se ransomware bránit.\cite{Enisa_thread_landscape}

\nlparagraph{Změny v metodice}
Ze zaznamenaných dat jasně vyplývá pokles útoky s počátečním vektorem prostřednictvím \firstac{RDP}, neboli protokolem vzdálené plochy.
Stále je to však druhý nejpoužívanější vektor útoku pro ransomware.
Útočníci stále prolamují slabá \ac{RDP} přihlašovací jména a hesla, zejména pokud není povolena \firstac{MFA}, v překladu vícefaktorová autentizace.
\ac{MFA} je velmi dobrou obranou proti neznalým útočníkům a jednodušším útoků, bohužel není nepřekonatelná.
Nejpoužívanějším vektorem útoku je samozřejmě phishing.
Za povšimnutí stojí nízké nakladu na využití těchto metod útoku a jejich značný výnos, což je jeden z hlavních důvodů jejich oblíbenosti mezi útočníky
Zajímavým trendem jsou změny ve způsobu vydírání společností.
Klasický útok ransomware nejdříve sbírá informace, poté k nim zamezí přístup a posléze vydírá společnost.
Teprve pokud společnost odmítne zaplatit výkupné je útok veřejně oznámen.
Získaná data jsou také prodávána nebo volně dostupná na internetových fórech dark webu.
Některé ransomware skupiny však začali používat jiný postup.
Oběti je nabídnuto, aby si data \textit{koupila} dříve, než je zakoupí její konkurenti.
Útočníci také již po provedení útoku změnili vzhled webových stránek oběti aby o útoku oznámili.
Takto prováděný útok vede k veřejnému hanobení oběti útoku a má přímý vliv na vztahy s veřejností a reputaci společnosti.
Dalším znepokojivým trendem je vytváření dedikovaných stránek s daty o napadených přímo na veřejném internetu.
Tento postup zvolil \textit{ALPHV}, také známý jako \textit{BlackCat} ransomware, který operuje jako \ac{RaaS}\cite{ALPHV_blackcat}.
Na tomto webu se nacházely informace o zákaznících i zaměstnancích a ti si tak mohli snadno zkontrolovat, zda byli útokem zasaženi.
Vytvoření takto veřejného repozitáře se stalo novým způsobem, jak donutit třetí strany, aby se identifikovaly.
Lze předpokládat, že postižení zákazníci sami kontaktují majitele webu aby zaplatili za stažení dat.

\subsubsection{Spyware}
Specifický malware, jehož primárním cílem je shromažďování dat s nazývá spyware.
Při infikování zařízení sbírá osobní a citlivé informace nejen o uživateli ale i o samotném zařízení.
Získané informace spyware posílá nazpět svému tvůrci.
Všechny tyto činnosti samozřejmě provádí spyware bez souhlasu a znalosti uživatele.
Infikování je stejné jako většina malware, spyware je nevědomky nainstalován uživatelem.
Oblíbenou metodou je přibalení spyware k jinému programu nebo přes podvodné odkazy a soubory, které spouští instalační skripty.
Data, na která se útočníci zaměřují, jsou převážně přihlašovací údaje, údaje o bankovních účtech a kreditních kartách nebo také chování na internetu.
Všechna tato dala zde totiž prodat na černém trhu nebo rovnou využít k další nelegální činnosti.
Spyware je jedním z nejčastěji používaných způsobů kybernetických útoků.
Jeho oblíbenost spočívá v obtížnosti odhalení a při štěstí velkém výnosu.\cite{avast_spyware, fortinet_spyware}

\nlparagraph{Typy}
Všechny typy spyware monitorují uživatelskou aktivitu, rozlišujeme je na další typy podle toho, k čemu takto získaná data využívají a jak data získávají.
Některé spyware pořizují snímky obrazovky, jiné pouze monitorují běžící programy nebo jen vstup z klávesnice.
Vzácně je tento software dokonce schopen zapínat kameru či mikrofon a z nich nahrávat záznamy.
Dalším možným bodem odlišení jednotlivých typů jsou jejich dodatečné vlastnosti.
Některý typy spyware mají schopnost instalovat další software.
To umožňuje útočníkovi rozšířit své kompetence na zařízení, at už se jedná o pokročilejší sběr dat nebo manipulaci dat a nastavení přímo na daném zařízení.
Mezi nejpoužívanější typy patří:
\begin{itemize}
	\item Adware,
	\item Keylogger,
	\item Infostealer,
	\item Red Shell spyware,
	\item Cookies,
	\item Rootkit.
\end{itemize}\cite{avast_spyware, fortinet_spyware}

\nlparagraph{Adware}
Cílem adware je automatické zobrazování reklam bud přímo v prohlížeči nebo přímo v operačním systému zařízení.
V kontextu malware se jedná o tajně nainstalovaný software bez souhlasu uživatele.
Problémem je časté využíván k zobrazování invazivních nebo klamavých reklam.\cite{avast_spyware}

\nlparagraph{Keylogger}
Keyloggery jsou specifické programy pro zaznamenávání stisknutí kláves uživatelem.
Tyto informace jsou poté ukládány a zašifrovány.
Pokud keylogger funguje samostatně, tak tyto data také zasílá útočníkovi.
Častější je však použití keyloggeru spolu s dalším spyware.
Primárním cílem útočníka jsou běžně zadávané věci, které jsou v software chráněny.
Jedná se tedy například o přístupové údaje, soukromé zprávy a emaily.\cite{avast_spyware}

\nlparagraph{Infostealer}
Asi neklasičtější představa spyware, infostealer je útočníky využíván pro shromažďování informací z napadeného zařízení.
Již zmíněné keyloggery je možné uvažovat jako podtřídu tohoto spyware.
Jiné infostealery jsou například schopné prohledávat data na zařízení pro určité informace, určité soubory nebo typy souborů.
Častým cílem jsou přístupové údaje, emaily, zápisy z komunikačních aplikací nebo internetová historie.
Hlavní rozdíly jsou však ve způsobu operace.
Některé infostealery existují na zařízení až do jejich objevení nebo zničení zařízení.
Stále zasílají útočníkovi informace a to bývá primární důvod jejich objevení.
Zákeřnější jsou schopné najít a exfiltrovat všechna žádaná data najednou a pak se vymazat.
Pokud nejsou detekovány při tomto jednom přenosu, není pak možnost pro uživatele poznat, že byl napaden.\cite{avast_spyware}

\nlparagraph{Red Shell spyware}
Specializovaný spyware na sledování online aktivity hráčů.
Je nainstalován právě s danou hrou, u které sbírá data.
Původní záměr tvůrců je využít takto získaná data pro vývoj lepších her a pomáhat společnostem dělat lepší marketingová rozhodnutí.
Hlavním problémem je však instalace tohoto software bez vědomí uživatelů a jejich výslovného souhlasu.\cite{avast_spyware}

\nlparagraph{Cookies}
Cookies původně vznikly jako užitečná pomůcka, například pro přihlášení do oblíbených webových stránek uživatele nebo zachování instance v e-shopu.
Jsou také využívány pro zobrazování reklam spojených se zájmem uživatele, kterého sledují.
Jak již bylo naznačeno, problém je ve sledování online chování uživatele na internetu.
To cookies plně kvalifikuje jako spyware, který sleduje nejen historii prohlížení ale zaznamenává i pokusy o přihlášení.
Útočník s dostatečnými znalostmi a vybavením je tak schopen zpětně obnovit přihlášenou instanci.
Není proto divu, že o cookies se již delší dobu zajímá legislativa a hlavní internetové prohlížeče jejich činnost již v základu omezují nebo dokonce kompletně zakazují.\cite{avast_spyware}

\nlparagraph{Rootkit}
Možná nejnebezpečnějším typem spyware je Rootkit.
Ten umožňuje útočníkovi infiltrovat zařízení a získat přístup na velmi hluboké úrovni.
Rootkit je proto velmi obtížné odhalit.
Díky hlubokému přístupu má útočník značnou kontrolu nad zařízením, kterou většinou využije k instalaci a skrytí dalšího malware.
Při prvotním nakažení rootkit pro zisk přístupu nejčastěji využívá bezpečnostní zranitelnosti v samotném systému zařízení nebo administrátorské přístupy.
Jeho prvotní kroky jsou však detekovatelné dobrým antivirovým software.\cite{avast_spyware}

\nlparagraph{Dopad}
Jedním z nejčastějších problémů způsobených spywarem je krádež dat.
Všechna data mají pro útočníky cenu, některá jsou však vyhledávaná více nežli jiná.
Útočník se například může snažit sestavit falešnou identitu, kterou pak sám použije k další trestné činnosti nebo prodá na černém trhu.
Také přístupové údaje k účtům mohou být cenná data, vzácné účty se na černém trhu prodávají i za stovky dolarů.
Dalším příkladem cenných dat jsou přístupové práva, které může útočník použít k většímu kybernetickému útoku.
Vedlejším efektem spyware jsou problémy s přístupem k internetu nebo samotnou sítí.
Tyto problémy vznikají právě kvůli komunikaci dat zpět tvůrci.
Je to také jedním z ukazatelů na existenci spyware.
Dalším je zpomalení zařízení, jelikož v závislosti na sofistikovanosti spyware běžícího na pozadí bude zařízení ovlivněno.
V horších případech může spyware zařízení dokonce nevratně poškodit.
To se stává pokud je špatně navrženo nebo nezáleží na dlouhodobém sledování ale jde pouze o krátkodobou extrakci dat.\cite{avast_spyware, fortinet_spyware}

\nlparagraph{Pegasus spyware}
Jak již bylo zmíněno, spyware je také používán pro špehování na zakázku.
Již zmíněný Pegasus spyware spadá právě do této kategorie a je to výborný příklad.
Také více jak 30,000 aktivistů za lidská práva, novinářů a právníků po celém světě bylo cílem špehování.
Jeho použití ve státech \ac{EU} potvrdil i samotný tvůrce NSO\@.
Pegasus je velmi sofistikovaný spyware.
O jeho schopnostech svědčí i fakt, že společnost NSO musí získat povolení od izraelského ministerstva obrany předtím, než může být nástroj licencován pro jakéhokoli klienta.
V minulosti u něj výzkumníci pozorovali použití hned několik zero-day slabin za sebou k získání kontroly nad celým zařízením.
Po získání kontroly Pegasus zapnul mikrofon, kameru, četl zprávy, poslouchal hovory a sledoval polohu zařízení.
Všechna tato data posléze zasílal na NSO servery, kde k nim měli přístup zadavatelé špehování.
Při pohledu na oznámené případy používání Pegasus se často objevuje velmi nepříjemný společný motiv.
Proti cílené oběti dochází znepokojivě často k nějaké fyzické akci.
Existují případy, které vedly k uvěznění, fyzickým hrozbám, útokům a zastrašování.
Nejhorším případem je však vražda.
Jamal Khashoggi byl novinář ze Saúdské Arábie.
Původně blízký přítel královské rodiny byl nucen uprchnout ze země po jmenování Mohameda bin Salmána korunním princem.
Po úniku začal velmi otevřeně mluvit o represi v Saúdské Arábie.
V říjnu 2018 byl v Turecku nalákán do budovy saúdského konzulátu kvůli zřízení dokumentů pro bezpečný návrat do Saúdské Arábie.
z budovy však nikdy neodešel, byl uškrcen a rozčtvrcen.
Zkoumání odhalilo, že NSO nainstalovalo Pegasus na telefon jeho manželky Hanan Elatr jen několik měsíců před jeho smrtí\cite{khashoggi_wife_pegasus}.
Taká číslo telefonu jeho snoubenky bylo nalezeno mezi potencionálními cíli instalace Pegasus spyware.
Lze předpokládat, že Jamal Khashoggi byl také cílem sledování.
Při zohlednění těchto skutečností je použití Pegasus spyware zcela neetické.\cite{darknet_100_NSO,Enisa_thread_landscape}

\subsection{Sociální inženýrství}

%todo from my bakalářka

Phishing útoky jsou prováděny ve velkém objemu a cílí na širokou veřejnost, zatímco jiné útoky sociálního inženýrství využívají vlastní kampaně přizpůsobené konkrétním zaměstnancům. Při použití sociálního inženýrství útočníci využívají přístup zaměstnanců uvnitř organizace k získání technického základu v síti, ze které provádějí další útoky.

\subsubsection{Phishing}
Podvodné komunikaci, která předstírá že pochází z legitimního zdroje, se říká Phishing\cite{cisco_most_common_attack}.
Nejčastěji se jedná o emailovou komunikaci, existují však i formy přes sms nebo telefonní hovor.
Nejnebezpečnější jsou specializované útoky, zvané whaling a spear-phishing.
Většina útoků se snaží pokrýt velké spektrum populace, většinou omezené pouze záminkou, která je k útoku využita.
Specializované útoky jsou však tvořeny pro jednu specifickou osoby.
Útočník stráví týdny nebo i měsíce zjišťováním informací o cílené osobě a poté vytváří jeden specifický útok, který je v drtivé většině případů úspěšný.
Tato hrozba mívá 2 primární cíle.
Prvním je ověření nebo zisk informací, které lze použít k dalšímu útoku.
Druhým je kompromitace zařízení, například pomocí malware.
Nejčastěji je to pomocí odkazů, které se v podvodném emailu nachází, popřípadě pomocí infikovaných souborů.
Znepokojující je také každoroční nárostu počtu těchto útoků.\cite{moje_bakalarka}


\subsection{Threat against data}
%todo dopln

\subsubsection{Sql injection}
Tento známý útok využívá špatného nastavení databáze pro provádění za normálních okolností nepovolených operací.
Ze špatně zabezpečeného vyhledávacího boxu je útočných schopný zadáním specificky vypadajícího dotazu získat například výpis celé databáze.
%todo more? zdroje?

\subsection{Threat against availability}
%todo dopln

\subsubsection{Denial of service}
Útok zaměřený na kolaps infrastruktury.
\textit{Denial-of-service}, také znám jako \firstac{DoS} útok se snaží vyčerpat zdroje služby množství zasílaných požadavků.
Další možností je ovládnutí nebo alespoň vyřazení z provozu dané služby za pomocí známe zranitelnosti.\cite{cisco_most_common_attack}


Známější a více používaná je však podkategorie tohoto útoky zvaná \firstac{DDoS}.
Hlavní změnou je využívání mnoha zařízení, takzvaného \textit{Botnetu}, která na příkaz zahltí službu množstvím požadavků.
Problematika tohoto útoku spočívá v 2 hlavních bodech.
Při útoku \ac{DoS} je možné příchozí požadavky z jednoho zařízení snadno zablokovat pomocí \textit{blacklistu} daného zařízení.
To však není proveditelné pokud tyto požadavky přichází z tisíců nebo i statisíců zařízení.
S tím souvisí i druhý problém, rozsah celého útoku.
Jedno zařízení jen těžce může konkurovat statisícím v množství požadavků, které je schopné odeslat.
A to i za předpokladu, že je mnohem výkonnější.
%todo more? zdroje?

\subsubsection{Internet threats}
%todo dopln

\subsection{Ostatní}
Tato kategorie se skládá z útoků, hrozeb a technik, které nelze zařadit samostatně do jedné kategorie ale jsou často využívány v kombinaci s jinými kategoriemi útoků.
je nutné je v tomto výčtu zmínit kvůli jejich nebezpečnosti, rozšířenosti a nízkému veřejnému povědomí.

\subsubsection{Man-in-the-middle}
Útoky \textit{Man-in-the-middle} jsou také zvané odposlouchávací útoky.
Útočník se při tomto útoku dostává doprostřed komunikace 2 subjektů.
Hlavním cílem je filtrování, kradení a nahrazování dat proudících v komunikaci.
Mezi nejčastější implementace tohoto útoky patří napodobování veřejné \textit{Wi-Fi}.
Útočník se představuje jako vstupní bod na tuto veřejnou wifi kap posléze odesílá veškerou komunikaci.
Lidé si tak nemusí uvědomit, že útočník existuje a nedávají si tak pozor na svoji činnost na takto odposlouchávané síti.
Další oblíbenou implementací útoku je použití malware.
Ten po nainstalování přesměrovává komunikaci nebo pouze odposlouchává činnost na daném stroji.\cite{cisco_most_common_attack}
%todo more?

\subsubsection{Zero day exploit}
\textit{Zero day exploit} je slabina na kterou ještě neexistuje patch.
Tato situace může nastat pokud byla slabina nahlášena a ještě ji výrobce systému nestihl opravit.
Mnohem častější je případ, kdy slabinu našel sám útočník.
Ten ji pouze bude chtít využít, rozhodně ne nahlásit.
Tyto slabiny se také snaží získat státní složky zaměřené na špehování.
Nemůže tak být divu, že s těmito slabinami existuje černý trh\cite{world_end_2021} kde se prodávají až za miliony dolarů.
%todo more? zdroje?

\subsubsection{DNS tunneling}
\textit{DNS tunneling} je možné použít pro legitimní účely, tato práce však zkoumá jeho zneužití.
Není to samotný útok ale podpora útoku.
Je založený na \firstac{DNS}.
Tento protokol je využíván prakticky neustále pro běžné účely a je velmi flexibilní.
To však dovoluje jeho zneužití.
\ac{DNS} je tak často používán, že malé navýšení není poznat.
Mnoho společností ho navíc nekontroluje dostatečně, aby mohlo tento typ útoku možné odhalit.
Útočník v \ac{DNS} requestech a responsech zakódovává vlastní komunikaci za účelem jejího skrytí.
Odchozí komunikace může být použita pro exfiltraci kritických dat nebo přijímání odpovědí od nainstalovaného malware.
příchozí naopak pro posílání příkazů již nainstalovanému malware nebo dokonce stahování dalšího malware.\cite{cisco_most_common_attack, bright_sec_dns_tunneling}
%todo more? zdroje?

\subsubsection{Supply-chain útoky}
%todo add

\section{Kategorie útočníků}
Pro kompletnost je při zkoumání bezpečnostního nutné uvažovat i typu útočníka, který útok uskutečňuje.
Různé typy se chovají během útoku různě, mají jiné cíle, možnosti a motivace.
Pokud je cílem komplexní ochrana, je nutné zvážit, se kterými typy útočníku bude nejčastější konflikt.
Pro zjednodušení je možné útočníky zařadit do několika skupin.
Stejně jako u útoků mezi skupinami existují návaznosti a překrývání, je nutné skupiny brát pouze jako hrubé zařazení a ne definitivní výčet.
Skupinami jsou:
\begin{itemize}
	\item Příležitostný útočník,
	\item Script kiddie,
	\item Hacktivista,
	\item Hacker na objednávku,
	\item Cyber kriminálník,
	\item Státem podporovaný útočník,
	\item Insider (vnitřní osoba).
\end{itemize}\cite{Enisa_thread_landscape,data_flair_attackers}

\subsection{Příležitostný útočník}
Tento typ útočníka by bylo možné nazývat také hobby útočník.
Mají omezené zdroje a bývají velmi specifičtí v rámci postupů a zranitelností, které využívají k dosažení svého záměru.
Tito útočníci nejsou plně zaměřeni na hackování, je to pro ně spíše zábava a zpestření života.
Z toho také vyplývají hlavní motivace těchto útočníků.
Cílem je získat proslulost.
Existují fora dedikované těmto útočníkům, kde se navzájem chlubí svými útoky ostatním.
Můžeme tak očekávat, že útoky budou směřovány k jasně viditelným avšak málo destruktivním typům.

\subsection{Script kiddie}
Vě většině případů nejméně schopní útočníci.
Jsou to amatéři, kteří používají volně dostupné nebo zakoupené nástroje bez hlubších znalostí systémů a hackování.
Většinou bývají neškodní, teprve se učí a mají omezené znalosti a možnosti útoku.
Proto jsou jejich útoky málokdy úspěšné a i v případě úspěchu často nevědí, jak pokračovat.
Lze tak předpokládat nízkou úroveň poškození u útoků, snadno odhalitelné útoky a nízkou sofistikovanost.
Jediným výrazným rizikem jsou zakoupené nástroje pro specifické účely.
Ve výjimečných případech kdy bývá motivací pomsta zakupují script kiddies na černém trhu nástroje pro konkrétní devastující útok.
Ve většině případů se však jedná o nováčky kteří hledají výzvy a adrenalin.
Pokud má skript kiddie pro hackování talent, může se díky zisku zkušeností a znalostí stát v průběhu času profesionálním hackerem.

\subsection{Hacktivista}
Útočníci motivování politickými nebo ideologickými názory jsou nazýváni hackticvisti.
Provádějí škodlivé útoky pro zviditelnění a prosazení své agendy.
Možná nejznámějším příslušníkem je skupina Anonymous.
S velikostí skupiny je očekávaná jistá fragmentace, a tak se anonymous hlásí k množství incidentů s různými agendami.
Za speciální zmínku stojí jejich kybernetické útoky proti Rusku v souvislosti s válkou na ukrajině\cite{anonymous_russian_attacks}.
Jak je jasné, motivací hacktivistů není zisk, ale snaha bojovat za spravedlnost.
Jejich útoky tak bývají ve vážnosti v rozmezí od neškodných, jako je změna webové stránky, po drastické kde vede k poškození infrastruktury a zničení nebo vyzrazení citlivých dat.
Také není neobvyklá spolupráce s Insidery, kteří sdílí jejich přesvědčení nebo je upozornili na objekt jejich zájmu.
Lze tedy říci, že hacktivisté mohou dle svého přesvědčení být kvalifikování jako síla dobra i zla.


\subsection{Hacker na objednávku}
Skupina schopných hackerů kteří své vědomosti a znalosti propůjčují jiným osobám či organizacím jsou hackeři na objednávku.
Nemůže být překvapením, že velká většina hackerů více či méně spadá do této skupiny.
Skupina se totiž navíc dle motivace,metodologie a záměru dělí na podskupiny, zvané \textit{White hat, Gray hat} a \textit{Black hat} hackeři.

\nlparagraph{White hat hackeři}
\textit{White hat hackeři} využívají své schopnosti ve spolupráci s organizacemi k určení jejich slabých míst v zabezpečení.
Tito hackeři se řídí silným etickým kompasem, který je jasně zřetelný z jejich činnosti a zaměření pro zlepšení zabezpečení.
Pracují s svolením organizace a v jasně vymezených hranicích, což však může vázat jejich schopnost odhalit veškeré slabiny.

\nlparagraph{Black hat hackeři}
\textit{Black hat hackeři} jsou neetický opak white hat hackerů.
Jejich primární metodikou je prolamování obrany systémů a sítí bez vědomí organizace.
Cílem těchto hackerů je vždy svůj vlastní prospěch.
Existuje mnoho možností, jak tohoto prospěchu dosáhnou.
Někteří napadají společnosti a exfiltrují data uživatelů, která pak prodávají na černém trhu.
Jiný využívají tato data k bankovním podvodům, kampaním sociálního inženýrství nebo kradení účtů.
Další možností je pouze vyhledávání slabin a jejich následný prodej na trhu slabin.
Státní organizace jsou za takzvané \textit{zero day slabiny} ochotné zaplatit i statisíce dolarů\cite{world_end_2021}.
Tam kde by slabinu etický hacker ohlásil aby mohla být napravena ji neetický hacker prodá za značnou sumu peněz.

\nlparagraph{Gray hat hackeři}
\textit{Gray hat hackeři} jsou na pomezí předchozích kategorií.
Jestli boudou klasifikování blíže k white hat hackerovi nebo black hat hackerovi závisí na situaci.
Mnohdy využívají metodologii black hat hackerů k odhalení slabin, ale místo prodeje nebo zneužití slabiny ji dané organizaci nahlásí.
Nesnaží se tak způsobovat škodu, ale odhalit slabiny zabezpečení, které by mohly být nemožné odhalit pro white hat hackera.
To však bohužel stále znamená napadení organizace či osoby a ty nemusí reagovat kladně na pozdější oznámení útoku.
Také občasné požadavky platby za napravení slabiny nebo její nevyzrazení jim nedělá nejlepší jméno.
Asi nejlepším příkladem tohoto fenoménu je kauza okolo Twitteru Donalda Trumpa, jeho hesel a hackerů nazývaných \textit{The Guild of the Grumpy Old Hackers}\cite{darknet_87_grumpy}.
Této skupině hackerů se povedlo několikrát získat přístup k Twitter účtu Donalda Trumpa, a to v letech 2016 a 2020.
Pro kontext, Donalt Trump byl v roce 2016 kandidát na prezidenta Ameriky a v roce 2020 dokonce prezident.
Po obou těchto úspěšných útocích to sami hackeři nahlásili, avšak i tak se nevyhnuli soudnímu řízení.
Naštěstí byl jejich postup zcela legální a byly tak zproštěni viny.

\subsection{Cyber kriminálník}
Tato skupina útočníků jsou jednotlivci nebo dokonce organizované skupiny zaměřené na finanční zisk pomocí kriminální aktivity.
Mezi jejich činnosti patří ransomware, těžba kryptoměn, krádež kryptoměn nebo krádež přihlašovacích údajů, které využívají pro další činnosti.
Množství těchto útočníků stoupá také díky stále nižší vstupním nárokům díky \ac{MaaS}\cite{MaaS_ATaT} a \ac{RaaS}\cite{RaaS_microsoft}.
Zajímavým trendem posledních let je navíc neustálé přejmenovávání a `odcházení do důchodu' kriminálních skupin.
Cílem je vyhýbání se zákonnému stíhání a sankcím, jelikož je na tyto skupiny kladena stále větší pozornost.

\subsection{Státem podporovaný útočník}
Útočníci úzce spojeni s určitým státem.
Jejich motivace a cíle jsou vždy v zájmu jejich státu.
Útoky jsou tedy často zaměřené na posílení svého státu v politické nebo vojenské sféře.
Je jasné, že tito útočníci mají téměř neomezené zdroje, vyspělé technologie a prvotřídní znalosti.
Proto jsou od nich časté sofistikované a rozsáhlé útoky.
Lze tedy očekávat průmyslovou špionáž, úniky státních tajemství, cílené kybernetické útoky na infrastrukturu ale také rozsáhlé ransomware kampaně a podvody s kryptoměnou.
Není neobvyklé, že státy rekrutují úspěšné hackery ze všech možných zdrojů.
Existují spekulace o rekrutování i mezi kryminálníki.
Mnoho spekulací koluje například kolem skupiny REvil, kterou Rusko zatklo na začátku roku 2022\cite{REvil_story}.
Bohužel již o pár měsíců později se znovu začaly objevovat známky jejich aktivity.
Jak je však u státem sponzorovaných akcí trendem, daný stát jakoukoli vazbu popírá a tento fakt lze jen těžko vyvrátit.
Bylo identifikováno hned několik skupin, kde je návaznost na stát téměř jistá.
Příkladem je \textit{Lazarus Group} pro Severní koreu, \textit{Sandworm Team} pro Rusko nebo \textit{APT41} spojený s Čínou\cite{Mitre_groups}.

\subsection{Insider (vnitřní osoba)}
Insider je osoba pocházející z organizace, která způsobila chtěně nebo nechtěně bezpečnostní incident.
Představuje tak značnou hrozbu pro bezpečnost celé organizace.
Většina bezpečnosti je nastavena na venkovní hrozby.
Nebezpečí insidera je právě v naprosté neefektivitě takto postavené obrany vůči němu.
Systém nemůže být nikdy stejně chráněný z venku jako zevnitř
Insider takto nastavenou ochranu obejde a dostane se přímo ke zranitelným místům.
Velmi často jsou těmito insidery nespokojení zaměstnanci, bývalí zaměstnanci, dočasní pracovníci nebo dokonce zákazníci.
Je proto velmi důležité správně nastavit přístupy do systému a při odchodu zaměstnanců jim přístup včasně odebrat.
Insidery můžeme dle úmyslu dělit na tři hlavní kategorie, kterými jsou \textit{Úmyslný insider}, \textit{Nechtěný insider} a \textit{Nedbalý insider}.

\nlparagraph{Úmyslný insider}
Úmyslný insider je ten, kdo vědomě způsobí svojí organizaci újmu.
Mezi příklady se řadí krádeže dat, úmyslné poškození infrastruktury nebo vydání přístupu třetí neoprávněné osobě.
Cílem těchto insiderů bývá často pomsta nebo jen peněžní zisk.
Speciálním případem této kategorie je takzvaný \textit{whistleblowing}.
Tento termín označuje veřejné upozorňování na trestné, neetické nebo podezřelé jednání firem či státních institucí jejich zaměstnanci.
Tohoto zaměstnance lze tedy také považovat za úmyslného insidera, který však vyzrazuje informace v dobré víře a nejedná ve vlastní prospěch.
Velice známým zástupcem je Edward Snowden, který v roce 2013 veřejnosti odhalil existenci rozsáhlých programů na sběr informací fungujících pod záštitou \firstac{NSA}\cite{Edward_Snowden}.

\nlparagraph{Nechtěný insider}
Může se stát, že insiderem se stane běžný zaměstnanec.
Shodou okolností se dopustil nějaké chyby která poškodila firmu.
To však nebylo úmyslem a ani tato situace nenastala v rámci zanedbání povinností.
Může se například jednat o náhodné smazání nebo modifikace důležitých souborů, nechtěné vypojení zařízení ze zásuvky.

\nlparagraph{Nedbalý insider}
Některé hrozby vznikly kvůli nedbalosti zaměstnance.
Tne pak figuruje jako nedbalý insider.
Situace nastane, když zaměstnanec nedodržuje správné postupy, politiky nebo metodologie, které organizace stanovila.
Tyto postupy vzniklý právě pro ochranu důvěrnosti, integrity a dostupnost dat.
Jejich nedodržování je proto značný bezpečnostní problém.
Je však nutné zkoumat, zda toto nedodržování plyne z nerealisticky nastavených politik nebo pouze chyb zaměstnance.
Další možností jsou také nedostatečné znalosti a zaškolování zaměstnanců pro vykonávání možné činnosti.
Je jasné, že v mnoha případech může být obtížné rozeznat, zda se jedná o nedbalého nebo pouze o nechtěného insidera


\section{Testování}
Smyslem testování je simulovat útok na infrastrukturu systému.
Vě většině případů to znamená, že se specialista na bezpečnost snaží provádět stejné kroky jako potencionální útočník.
Většina případů však nejsou všechny.
Ideální postup vylučuje nejen nepředvídatelnost útočníka, ale ve výjimečných případech i jeho neschopnost nebo neznalost.
Stejně jako v každém odvětví existují i mezi útočníky sféry kompetence a znalostí.
Existuje mnoho útočníků, kteří se touto činností nejen živí ale je to také jejich vášeň.
Takovýto útočník bude disponovat znalostmi a technikami které nejsou běžné.
Při útoku bude postupovat co možná nejoptimálněji za účelem dosažení výsledků.
Je možné od něj očekávat pozorné zkoumání cíle a vytrvalost, díky které se si cíl zvolí.
Tiše hledá slabiny a proniká do střežených systémů bez povšimnutí.
Ne každý útočník je však takto nebezpečný.
Drtivá většina útoků je prováděna nadšenci nebo útočníky bez obsáhlých znalostí a technik útoku.
Není tak vyloučeno použití snadno detekovatelných `hlučných' technik nebo prostých chyb, kterými na sebe při útoku upozorní.
Nebezpečnost této skupiny v posledních letech vzrostla díky propagaci \firstac{MaaS}\cite{MaaS_ATaT} a \firstac{RaaS}\cite{RaaS_microsoft}.
Existence nástrojů, které dovolují provézt úspěšný útok za pomocí znalostí zkušenějšího útočníka znamená, že ani nezkušené útočníky není možné podceňovat.

\paragraph{}
Testování je jedna z nejlepších možností, jak zlepšit obranyschopnost organizace.
Nemilou samozřejmostí je, že největší změny v ochraně přichází po bezpečnostním incidentu.
Ztráta dat, poškození reputace organizace nebo i finanční postihy jsou výborné motivace nejen pro obránce ale i management organizace věnovat zabezpečení větší úsilí.
Pokud se útočníkovi podařilo prolomit ochranu organizace, jasně to ukazuje na nedostatky, které je nutné napravit.
Bezpečnostní incident tak se kromě mnoha nepříjemností ukazuje, jak dobře byla organizace připravena.
Dle reakce obránců lze zkoumat jejich celková připravenost.
Dobře připravení obránci mohou nebezpečný incident zaznamenat včas a pokud jeho následku nejde zabránit, mohou ho alespoň omezit.
Nepřipravení obránci nemusejí zaznamenat incident ani měsíce po jeho uskutečnění a několikanásobném zopakování.
Organizace a její obránci musí vědět, jak postupovat v případě incidentu.
Testování je simulace bezpečnostního incidentu ale bez většiny jeho negativ.
V závislosti na druhu testování je možné vyzkoušet připravenost obránců, jejich obezřetnost a postupy v případě detekce podezřelé činnosti.
Můžeme testovat robustnost infrastruktury, zda je kvalitně navržena a správně nastavena.
Můžeme testovat zařízení, zda fungují správně a nelze je zneužít.
Můžeme testovat technologie, zda jsou správně využívány popřípadě zda je jejich využívání nutno omezit nebo naopak rozšířit.
Důvodů, proč by mělo být testování součástí zlepšování obranyschopnosti každé organizace je tedy mnoho.
Testování přináší tolik benefitů protože to není prostá reakce na událost ale příprava.
Cílem organizace je zajistit, aby žádný bezpečnostní incident nebylo možné stejně uskutečnit dvakrát.
Čím více je poprvé uskutečněno pomocí testování, tím více jich bude zaznamenáno a zastaveno při skutečném útoku.


\subsection{Rozsah testovní}
Obránci se musí přizpůsobovat a testovat nejen nejběžnější a nejefektivnější útoky ale i krajní scénáře.
Toto přizpůsobování vedlo nejen k různým testovacím metodikám jako \textit{Red teaming} a \textit{Penetration testing} ale také k testování různých scénářů a hlavně rozsahů.
Mezi nejznámější patří \textit{celkový pokus o kompromitaci}, \textit{specifický pokus o kompromitaci} nebo \textit{předpokládaný kompromis}.
Je samozřejmé, že každá tato kategorie obsahuje další podkategorie.
Toto základní rozdělení je však vhodné pro rozpoznání hlavních výzev, složitostí ale i přínosů testování.
Nelze říci, zda je jeden scénář lepší nežli jiné, naopak se doplňují a každý slouží pro určitou situaci.\cite{red_team_oakley_2019}

\subsubsection{Celkový pokus o kompromitaci}
Základní situací je \textit{celkový pokus o kompromitaci obrany}.
Lze definovat jako snaha \textit{red teamu} napadnout celou infrastrukturu organizace a pokusit se kompromitovat co možná největší možnou část.
Tato strategie je vhodná pro celkové testování infrastruktury.
Je to nejbližší emulace skutečného útoku.
Testování ve většině případů začíná ze stejného bodu, který je běžně dostupný veřejnosti a tím pádem i útočníkům.
Lze takto testovat správnou segmentaci infrastruktury a resistivity jednotlivých segmentů.
Z velkého a otevřeného rozsahu však vyplývá jen omezená možnost testování do hloubky a zaměření se na specifické části infrastruktury.
\textit{Red team} má pouze omezený čas a prostředky, proto nachází pouze nejčastější slabiny na celém rozsahu testování ale nemá možnost testovat jednotlivé části do hloubky a pro všechny možné hrozby.
Při nesprávném provedení nebo nepochopení cíle tohoto testování může vznikat falešný pocit bezpečnosti, který je pro zabezpečení nebezpečný.
cílem tohoto testu je získat celkové povědomí o ochraně a poté pokračovat s podrobnějším testováním.
%todo add picture?

\subsubsection{Specifický pokus o kompromitaci}
Pro testování omezené části infrastruktury se využívá \textit{specifický pokus o kompromitaci}.
Cílem je důkladně otestovat omezenou část infrastruktury bez využití, zásahu nebo omezení částí infrastruktury nacházející se mimo testovaný rozsah.
\textit{Red team} prování podrobné testování, které při korektním provedení vede k nalezení všech slabin.
Výhodou tohoto testování je jeho specificita, je možné testovat určitou oblast infrastruktury nebo jen určité zařízení a to pouze za určitých podmínek.
Příkladem může být testování za použití specifického účtu a s ním spojených pravomocí přístupu.
Další výhoda je možnost testování v běžném provozu.
Krátkodobě vyřadit a testovat část infrastruktury je proveditelnější nežli celkové vyřazení nebo testování za běžného provozu.
V takovém případě je však nutné dávat pozor na správné vybrání rozsahu.
Při důkladném testování není neobvyklé vyřazení testovacího zařízení z běžného provozu nebo jeho zhroucení.
Je tak důležité aby nebyl testován systém, který je kriticky důležitý nebo zrovna používaný.

\subsubsection{Předpokládaná kompromitace}
Z názvu je jasné, že toto testování zkoumá, jakou škodu může útočník napáchat při úspěšném útoku.
Počáteční bod tohoto testování je založen na předpokladu úspěšné infiltrace útočníkem.
Přístup k takto identifikovanému bodu je s příslušnými právy poskytnut \textit{red teamu}, který nemusí prolamovat obranu systému.
\textit{Red team} se tak může plně soustředit na zkoumání dopadu úspěšného útoku.
Důvod, proč toto testování není pouze součástí předchozích testování je úspora času a prostředků.
Vhodným příkladem jsou útoky sociálního inženýrství a phishing.
Jsou to často testované útoky díky jejich četnosti, jejich výsledek a prolomení systému však není okamžité.
Může trvat i týdny než uživatel otevře email a nainstaluje malware.\cite{red_team_oakley_2019}
Z důvodu efektivity je tedy lepší předpokládat úspěch útoku a začít testovat z bodu malware nakaženého uživatelského stroje.
Tento typ testování je výhodný pro ukázku dopadu úspěšného útoku.
Častým problémem bezpečnosti je její nedocenění dokud funguje správně.
Ve chvíli kdy nastane problém je však většinou pozdě.
Proto tento typ testování představuje nástroj prokázání důležitosti kvalitní obrany ukázkou důsledků jejího selhání.

\subsection{Metodologie testování}
ještě důležitějším rozhodnutím než jak široce testovat je způsob testování.
možná nejznámější jsou 3 hlavní testovací metodologie: Penetration testing, Red team assessment a Purple team/kontrolní cvičení.
Samozřejmě stejně jako i u rozsahu testování i u těchto metodologií existuje určitý přesah.
Z tohoto důvodu jsou tyto metodologie nepřesně definovány, někdy zaměňovány nebo dokonce považovány za jedinou metodologii s několik různými názvy.
Je proto nutné si je představit v kontextu tohoto textu.
K tomu slouží následující sekce.\cite{securityInteligence_pen_test_red_team_purple_team}

\subsubsection{Penetration testing}

Penetration testing, často také zkracován na pen testing, je metodologie s cílem vyhledání co nejvíce možných zranitelností testovaného systému.
Takto důkladné hledání je omezeno pouze na zadaný `scope', neboli část testovaného systému.
Aby bylo dosaženo co největší efektivity, tento typ testování se svoji činnost nesnaží schovávat, naopak bývá velmi snadné ho detekovat, to však nevadí protože ochrana daného systému by o jeho provádění měla být předem informována.
Tento typ testování může být také z části automatizován, což vede k dalšímu zlepšení efektivnosti na úkor flexibilitě.
V neposlední řadě Penetration testing vyžaduje menší množství zdrojů, ať už v podobě času, lidí či kapitálu, než red team assessment.
\paragraph{}
Ve shrnutí, Penetration testing je hledání co nejvíce zranitelnosti v zadané oblasti bez nutnosti svoji činnost maskovat před ochranou systému.\cite{securityInteligence_pen_test_red_team_purple_team, lootsec_pen_test_vs_red_team, astra_pen_test_vs_red_teaming}


\subsubsection{Red team assessment}

Red team assessment, také referovaný jako red teaming, je na rozdíl od pen-testingu zaměřen na dosažení zadaných cílů, například získání přístupu k citlivým datům, nebo testování všímavosti ochranných systémů.
To také znamená, že red teaming není omezen oblastí, kterou může v rámci dosažení svého cíle využít.
Obrana systému není ze zřejmých důvodů seznámena s nadcházejícím testováním, proto tato metodika vyžaduje maskování a opatrný přístup, aby pokud možno co nejvíce simulovala skutečný útok.
Výhodou je, že za předpokladu detekce testování bude obrana systému postupovat stejně, jako kdyby se jednalo o skutečnou hrozbu a získáme tak cenná data a zpětnou vazbu pro zlepšení budoucí obrany.
Je jasné, že pro správné provedení red teamingu je potřeba více zdrojů, at už se jedná o čas nebo lidskou práci, než v případě pen testingu.
Také automatizace zde bývá složitá, jedná se totiž o specifickou strategii pro každé testování kde je nutnost reagovat na všechny události vzniklé testováním.\cite{securityInteligence_pen_test_red_team_purple_team, lootsec_pen_test_vs_red_team, astra_pen_test_vs_red_teaming}

\paragraph{}
Ve shrnutí, red team assessment je zaměřen na testování obranyschopnosti cíle s omezeními vznikajícími pouze ze snahy simulovat reálný útok.


\subsubsection{Purple team/Kontrolní cvičení}
Specifická situace je pak blízká spolupráce útočníků (Red team) a obránců (Blue Team).
Hlavní výhodou tohoto postupu je zpětná vazba mezi útočníky a obránci, kde se dá testovat detekce a následná odezva obránců při testování specifických technik obsažených v MITRE ATT\&CK frameworku.
Další výhodou je seznámení s postupy druhé strany pro tvorbu efektivnějším strategií, at už se jedná o útočníky nebo obránce.
\paragraph{}
Tato cvičení lze uskutečňovat pouze jednou pro vyzkoušení techniky nebo také opakovaně.
Částečná automatizace za použití open-source nástrojů, které mají v této práci vlastní kapitolu, je také jednou z možností.
Výhodou opakovaného testování s automatizací je možnost měřit a porovnávat výsledky za stejných stupních podmínek, což vede k jasně viditelnému zlepšení obranné strategie.\cite{securityInteligence_pen_test_red_team_purple_team,redscan_team_purple_team}

\section{Zavedené nástroje v problematice Testování}
Pro účely testování je dobré využívat stávající technologie.
Je jasné, že každé testování prostředí je jedinečné.
To však neznamená, že není možné těžit z poznatku ostatních obránců.
Vzniklo mnoho nástrojů, jejichž cílem je pomoci nejen s rozeznáváním útoků ale i se samotným testováním.
Asi nejznámějším frameworkem pro kolekci útoků a jejich rozeznávání je MITRE ATT\&CK\cite{mitre_attack_framework}.
Tento framework je open-source, volně dostupný a obsáhlý.
Existuje množství testovacích frameworků, které jsou s MITRE ATT\&CK kompatibilní\cite{csoonline_4_testing_frameworks}.
Příkladem \firstac{RTA}, Caldera nebo Atomic Red.
Tyto frameworky jsou na rozdíl od jiných zdarma a proto se hodí pro začátek testování.
Je dobré si nejdříve vymezit testovanou oblast.
Všechny tyto frameworky budou více probrány a porovnány v následujících kapitolách.

\subsection{MITRE ATT\&CK}
MITRE ATT\&CK je bezplatná otevřená znalostní databáze popisující chování útočníků a techniky, které tyto útočníci využívají.
Tato znalostní báze je založená na pozorování v rámci reálného světa, data pochází z veřejného zpravodajství a hlášených bezpečnostních incidentů.
Samozřejmě jsou začleněny i veřejné výzkumy technik útočníků.
Je aktivně udržována, nové informace jsou přidávány dvakrát do roka\cite{mitre_attack_framework_faq}.
Hlavním přínosem tohoto projektu však není pouze mapování útočníků, ale celková klasifikace útoků do jednotlivých \textit{taktik, technik a sub-technik}.
framework tak obráncům nabízí možnost rozložit složitý útok na jeho jednotlivé stavební kameny.
ATT\&CK je velmi podrobný a dokonce u jednotlivých technik útočníků nabízí možnosti detekce a obrany.
Obránci proto mohou snáze porozumět stylu práce útočníků, technikám které používají ale nejdůležitěji, jak tyto informace využít k vytvoření lepší obrany.
Všechny tyto informace jsou navíc přehledně dostupné v interaktivní formě pomocí ATT\&CK navigátoru\cite{mitre_attack_navigator}.
V něm je možné provádět vizualizaci a porovnávání útoků.
Je tedy snadné prezentovat rozbor útoku dalším osobám a díky exportování a importování je snadné studovat již popsané útoky a sledovat nejpoužívanější taktiky a techniky.
Není proto divu, že je MITRE ATT\&CK v době psaní tohoto textu považován jako jeden z nejvýznamnějších standardů pro popis technik používaných útočníky při kybernetických útocích.\cite{mitre_attack_framework}

~\clfig{Mitre_Attack_Navigator}{\linewidth}{Mitre ATT@CK Navigátor}{\cite{mitre_attack_framework}}{fig:navigator}

\subsubsection{Členění}
Díky popularitě ATT\&CK došlo k jeho velkému růstu.
Je jasné, že s přidáváním taktik a technik vzrůstá nepřehlednost.
Také rozšiřování zaměření nakonec vedlo k nutnosti rozdělení, aby byla zachována přehlednost a funkcionalita.
Proto existují specifikace pro určitá odvětví:

\begin{itemize}
	\item \textbf{Enterprise} - síťové a cloudové technologie,
	\item \textbf{ICS} - průmyslové řídící systémy,
	\item \textbf{Mobile} - mobilní zařízení.
\end{itemize}

\paragraph{}
Samozřejmě i jednotlivá odvětví jsou dále rozdělena na domény dle zaměření útočníků.
U Enterprise je rozlišování pro Windows, macOS nebo Linux a také cloud, network a containers.
Mobilní platforma odlišuje Android a iOS\@.
Toto rozdělení dává smysl, stejná technika bude jinak aplikována na různých systémech a díky tomuto rozdělení je možné zamířit se právě na jeden určitý use-case útoku.

\subsubsection{Taktika}
Taktika představuje nejvyšší úroveň abstrakce modelu ATT\&CK\@.
Představuje cíl útočníka, ne však jak se tohoto cíle útočník snaží dosáhnout.
Příkladem můžeme zmínit \textit{Impact(Dopad)}.
Taktika dopadu je zaměřená na způsobení škody v podobě ohrožení integrity nebo dostupnosti dat.
Spadají do této taktiky techniky zaměřené na ničení nebo manipulaci dat.
Rozdělení na taktiky není ojedinělé, naopak na této abstraktní úrovni ATT\&CK těsně připomíná další modely hrozeb zaměřené na postup útoku a útočníka.
Důvod, proč je ATT\&CK preferován před jinými modely je jeho rozsah, provázanost a modelování namapované na proces navigace útočníka v napadaném systému.
Další výhodou je jasná rozlišitelnost taktik.
Jsou označené jedinečným řetězcem ve tvaru \textbf{TA0XXX} kde XXX je nahrazeno číslem jednotlivé taktiky.
Pozor na fakt, že taktika se stejným názvem, například \textit{Initial access(Počáteční přístup)}, bude označena jiným řetězcem v závislosti na odvětví do kterého spadá.
Pro enterprise je to \textbf{TA0001}, pro mobile \textbf{TA0027} a pro ICS se tato taktika značí \textbf{TA0108}.
Nelze tak dojít k záměně a nahlížet na techniky, které nejsou aplikovatelné na dané odvětví.\cite{Mitre_finding_cyber_threats, mitre_attack_framework}

\subsubsection{Technika a sub-technika}
Techniky jsou způsob, kterým útočník dosahuje svého taktického cíle.
To znamená, že v rámci každé taktiky existuje konečný počet popsaných akcí, jejichž provedením útočník dosáhne svého cíle.
Je jasné, že použité techniky se mění v závislosti na znalostech i možnostech útočníka.
Také je nutné brát v potaz prostředí, kde útok probíhá.
Popis taktik je však od těchto specifik oproštěn.
Důvodem je opět nutnost klasifikace, kdy není možné vytvořit téměř nekonečné množství technik pro jednotlivé útoky.
Jsou proto klasifikovány do kategorií technik, kde změny v metodologii nebo jednotlivé kroky jsou přidány pomocí sub-technik.
Tento postup umožňuje popsat nejdůležitější kroky chování útočníka aniž by se obránce ztratil v detailech.
Další výhodou je izolace od neustále vyvíjejícího kodu.
Základní metodika zůstává zachována, avšak jednotlivé implementace se v čase rapidně mění.
Stejně jako taktiky i techniky jsou označeny jedinečným řetězcem, který je ve tvary \textbf{TXXXX} kde XXXX je nahrazeno číslem jednotlivé techniky.
Pokud pro tuto techniku existují sub-techniky, připojuje se na konec řetězce \textbf{.XXX} jde XXX reprezentuje jednotlivou subtechniku.
Za příklad je možno uvézt techniku \textit{Phishing}, která je identifikována řetězcem \textbf{T1566}.
Technika phishing má také 3 sub-techniky, kterými jsou \textit{Spearphishing Attachment \textbf{[T1566.001]}}, \textit{Spearphishing Link \textbf{[T1566.002]}} a \textit{Spearphishing via Service \textbf{[T1566.003]}}


\paragraph{}
Techniky se jen málokdy vyskytují v izolaci, většinou na sebe stejně jako celé taktiky navazují.
Vytvářejí tak sled událostí, které vedou k úspěšnému útoku.
Schopnost identifikovat a propojit navazující druhy událostí je důležitou součástí obrany.
Cílem modelu ATT\&CK je totu schopnost co nejvíce usnadnit.
Data získaná z každého kroku v sekvenci pak nejen vypovídají o tom, zda se jedná o útok ale také obránci dovolují lépe vyhledávat další postup útočníka.
Je také možné, že podle cíle techniky je daná technika zařazena do více taktik zároveň.
Jedním takovýmto příkladem může být technika \textit{input capture(zachycení vstupy)}.
Ta spadá ve stejnou chvíli do taktik \textit{Collection(Sběr dat)} a \textit{Credential access(Pověření k přístupu)}.
Je jasné, že framework ATT\&CK nevypisuje všechny existující techniky útoku z dané taktiky.
Jeho založení na informacích získaných z opravdových bezpečnostních incidentů a komunity výzkumníků však vede k upřednostnění nejznámějších a nejpoužívanějších technik.
Zdá se to být nejlepší způsob, jak shromažďovat účinné informace o použití technik útočníka a jak je propojovat do užitečného analytického nástroje.\cite{Mitre_finding_cyber_threats, mitre_attack_framework}

\subsubsection{Další přínos}
V neposlední řade ATT\&CK také sleduje původ útoků, využitý software a zařazuje útoky do předpokládaných kampaní.
Tyto záložky jsou na hlavní stránce, specificky se jedná o \textit{Groups, Software} a \textit{Campaigns}.

\nlparagraph{Groups - skupiny}
Skupiny označují shluky útočníků, kteří operují se stejným cílem a je rozumná domněnka, že jsou mezi sebou v kontaktu.
Analytici sledují skupiny pomocí různých  metodologií a termínů.
Je proto možné, že různé skupiny analytiků nazývají jistou skupinu různými jmény, ATT\&CK se snaží tyto různá pojmenování respektovat.
Proto jsou u skupin zaznamenávány i alternativní názvy.
Také mezi jednotlivými skupinami dochází k částečnému překrytí, a to z důvodu pohyby útočníků a složitosti sledování skupin.
U kriminálních skupin je častý takzvaný \textit{rebranding}, kdy skupina změní své oficiální jméno nebo identifikační rysi za účelem zmatení autorit.
Pro zmatení ja také časté použití identifikačních rysů jiných skupin.
Proto je zaznamenávání a sledování obtížné.
Hlavním přínosem sledování skupin jsou informace o postupech a metodologiích útoku, které daná skupina preferuje.
Tyto informace jsou získány mapováním na veřejně oznámené použití technik a jsou uvedeny původní odkazy.
Je důležité zmínit, že informace nezobrazují všechny možné použití technik skupin, ale pouze podmnožinu, která byla zaznamenána.
I tak je to pro obránce značný přínos.
Při identifikaci metodologie útoku na určitou skupinu je možné předpovídat další kroky z předchozích záznamů a zmírnit tak dopad útoku.\cite{Mitre_groups}


\nlparagraph{Software}
Software je termín pro vlastní nebo komerční kod a nástroje používané útočníky pro provádění technik nebo taktik.
Stejně jako u skupin můžeme u software najít alternativní názvy právě díky sledování několika skupin.
Překrývání je týmem ATT\&CK a tyto názvy jsou označeny jako \textit{Associated Software}.
Informace o software pochází z veřejně oznámených technik a často bývají mapované na skupiny, které tento software využívají.
Je tedy opět nutné zmínit, že použití určitého software neznamená, že se jedná o související skupinu.
Pouze to znamená, že daná skupina tento software v minulosti použila.\cite{Mitre_software}


\nlparagraph{Campaigns - kampaně}
Pojem kampaň označuje rozsáhlou intruzivní aktivitu, která proběhla během určitého období s obecnými cíli a úkoly a byla značnou kybernetickou hrozbou.
Jedná se například o dlouhodobou průmyslovou špionáž nebo špionáž proti vládě určité země.
není neobvyklé, že do složité kybernetické operace je zapojeno několik přidružených skupin, přičemž každá hraje jedinečnou roli.
Například může být jedna skupina zodpovědná za počáteční průnik do systému a jiná za exfiltraci dat
Kampaň je označována názvem uvedeným ve veřejných zprávách nebo jedinečným identifikátorem ATT\&CK pokud kampaň ještě nebyla pojmenována.
Zaznamenání a sledování kampaní je obtížné.
Různé organizace zaznamenávající útok patřící do kampaně ho mohou oznámit pod různými jmény, a stejný útok navíc může být popsán z různých úhlů pohledu.
Tým ATT\&CK pro jednotlivé kampaně činí nejlepší úsilí o sledování překrývajících se jmen, která jsou označena jako `Přidružené kampaně'.
Toto sledování je výhodné, protože poskytuje informace nejen o existenci kampaně, ale také informace o technikách, které jsou využívány.
Pro referenci jsou tak kampaně mapovány na veřejně uváděné techniky a jsou v nich zahrnuty původní reference.\cite{Mitre_campaigns}

\subsection{Nástroje}
~\clfig{cso_mitre_open-source_attck_test_tools}{\linewidth}{Porovnání vybraných nástrojů}{\cite{csoonline_4_testing_frameworks}}{fig:OpenSourceTestTools}
% TODO maybe make my own table?

Než je zvolen finální framework pro testování, je nutné si nejdříve připravit co možná nejvíce informací týkajících se testování.
Je jasné, že každý z vybraných frameworků má své silné a slabé stránky.
Jak je vidět v tabulce ~\ref{fig:OpenSourceTestTools}, jedním z ovlivňujících parametrů je například testovaný operační systém.
Kde s atomic red je možné testovat na všech třech hlavních platformách, \ac{RTA} je přizpůsobené pouze pro Windows.
Specializace sama o sobě není špatná vlastnost, naopak většinou bývá přínosem.
Pokud však potřebujeme testovat Linux, je jasné že nemůžeme použít nástroj který toho není schopen.
Žádný z frameworků také nepokrývá celou MITRE ATT\&CK matice.
Proto lze předpokládat použití více nástrojů právě podle okruhu testování, na který je testování zaměřeno.

\subsubsection{Red Canary Atomic Red}
Ze všech uváděných příkladů je \textit{Atomic Red} nejvíce přívětivý rychlému začátku .
Pro jeho funkčnost není potřeba nic stahovat ani nastavovat, lze ho jednoduše použít z příkazové řádky\cite{redcanary_atomic_red}.
Další odlišnost je jeho ovládání.
Většina ostatních frameworků je založena na jazyku Python, popřípadě jiném skriptovacím jazyce.
Atomic red je ale spíše sada instrukcí odpovídajících jednotlivým taktikám a technikám Mitre ATT\&CK\@.
Atomic Red tedy není testovací software ale instrukce, jak testovat jednotlivé ATT\&CK taktiky s nástroji, které jsou již pravděpodobně nainstalované v počítači.
Je tedy vhodný pro naučení testovacích postupů ne však pro automatizované testování.
Uživatel při testování vždy musí provézt kroky útoku a sledovat výsledek.
To neznamená, že není možné simulovat složité útoky využívající hned několik technik.
Atomic red dovoluje techniky za sebou řetězit a vytvářet složité sequence útoků.
Výborným příkladem přímo od tvůrců je kod zvaný \textit{Dragons tail}\cite{redcanary_dragons_tail}.
Tento příklad se snaží napodobit chování skutečných útočníků.
Samozřejmě napodobení není dokonalé, ale dobře ukazuje možnosti Atomic Red pro složitější testování.\cite{csoonline_4_testing_frameworks}

\nlparagraph{Nevýhody}
Hlavní nedokonalostí tohoto přístupu je nutnost vytvářet nebo najít vlastní pomůcky.
Atomic Red je nástroj pro obránce a nechce útočníkům všechny potřebné prostředky pro provedení útoku.
To znamená že pomocné nástroje pro útok si musí obránce připravit sám.
Příkladem může být malware vložený v Microsoft Word dokumentu.
Atomic Red se snaží ukázat, jak malware operuje a jek ho útočníci využívají bez toho, aby ho útočníkům poskytl.
Dalším problémem je generace výstupních reportů.
Na rozdíl od dalších přístupů Atomic Red nevytváří automaticky stručný report o technikách které byly v útoku zkoumány.
Tato funkcionalita je bohužel až v pokročilejším placeném software který Red Canary nabízí.\cite{csoonline_4_testing_frameworks}

%todo add more after using it?
% TODO WRITER: text
%todo co to je, porovnání

\subsubsection{Endgame RTA}
\ac{RTA} v tomto kontextu znamená \firstac{RTA}.
Z představených nástrojů je to stále jednodušší, i když mocný nástroj.
Jediný povinný požadavek je Python verze 2.7, kde pro instalaci stačí rozbalit z gitu stažený repozitář.
Pro plnou funkcionalitu je však doporučeno navíc do podadresáře \textit{bin} vložit Sysinternals Suite a MsXsl.
Stále je to však jednoduchá instalace a celý návod se nachází přímo v git repozitáři.\cite{endgame_rta}

\nlparagraph{Schopnosti}
\ac{RTA} je složení téměř 50 různých skriptů simulujících útoky.
Bohužel jména těchto skriptů neodpovídají přesně Mitre ATT\&CK, i když jsou na ni založené.
Také zde neexistuje hyperlink navigace jako například u Atomic Red.
Práce se skripty proto vyžaduje více úsilí a určitou známost matice ATT\&CK\@.
Naštěstí jsou přesná označení technik, jako T1107 dohledatelné přímo ve skriptu.
Pro složitější testování je možné spouště všechny skripty najednou nebo vybrat některé pomocí podmíněného příkazu \textit{IF} přímo v kodu.
Pro základní automatizaci stačí, pro hlubší testovaní je tento nástroj však omezen.\cite{csoonline_4_testing_frameworks}

%todo probably better to use never EQL analytics library? https://eqllib.readthedocs.io/en/latest/
% TODO WRITER: text


\subsubsection{Mitre Caldera}
Caldera je od stejných vývojářů jako ATT\&CK, tedy Mitre.
Lze tak očekávat dobrou integraci a kompatibilitu mezi těmito nástroji.
Na rozdíl od dříve představených nástrojů je Mitre Caldera komparativně náročnější nástroj, což se projevili i v instalaci.
Ani tak však není instalace náročná, a to hlavně díky přípravě tvůrců a dobré dokumentaci\cite{mitre_caldera_docs}.
Framework caldera lze rozdělit na 2 hlavní části.
První je \textit{Jádro systému}.
Tento framework je dostupný v github repozitáři.
Zahrnuje asynchronní server pro řízení příkazů a kontrolu (command-and-control, C2) s REST API a webovým rozhraním.
druhou složkou jsou \textit{pluginy}.
Jsou to rozšíření pro možnosti jádra frameworku poskytující dodatečnou funkcionalitu.
Většinou se jedná o samostatné repozitáře.
Jako příklady je dobré uvézt agenty, hlášení, nebo  techniky z Atomic red team.\cite{mitre_caldera}

\nlparagraph{Systémové požadavky}
Autoři se snaží podporovat široké spektrum cílových systémů.
Proto existují 2 typy požadavků, povinné a doporučené.
Povinné určují, kde může být vůbec Caldera připravena.
Jádro frameworku může být nainstalováno na operačních systémech Linux nebo MacOS.
Pro fungování je vyžadován Python verze 3.7, 3.8, nebo 3.9 samozřejmě s rozhraním pip3.
Pip3 je vyžadován pro instalaci podpůrných balíčků uvedených v souboru \textit{requirements} přímo v repozitáři Caldery.
Ke správnému ovládání je vyžadován moderní prohlížeč.
Doporučený je Google Chrome.
Doporučené požadavky se týkají vývoje a správného fungování Caldery.
Je doporučený hardware s 8GB+ RAM a 2+ CPU\@.
Dále je pro správnou kompilaci a funkčnost Golang agentů doporučen GoLang 1.17+.
Za zmínku stojí také možnost instalovat a pracovat s Calderou v Docker kontejneru.\cite{mitre_caldera_docs}

\nlparagraph{Možnosti}
Caldera je oproti dříve představeným nástrojům složitý framework.
To je však více nežli dostatečně vyváženo dobrou dokumentací a hlavně možnostmi, které zkušenému uživateli Caldera nabízí.
Caldera dovoluje nastavení autonomních red-team nebo blue-team operací, a to plnohodnotně včetně závěrečného výpisu a exportování logů.
Existuje také možnost manuálních red-team operací, hlavně v případech nahrazování a testování pomocí vlastních nástrojů.\cite{mitre_caldera_docs}
%todo add more after using it?

\section{Praktická část}
% todosem narvat hafo obrázků

% TODO WRITER: text , úvod, bla bla

\subsection{Popis testovacího prostředí}\label{subsec:popis-testovaciho-prostredi}
Jako testovací prostředí bylo zvoleno Kali Linux.


Kali Linux je operační systém založený na Debianu, který je navržen pro testování zabezpečení a penetrační testování. Jedná se o distribuci Linuxu, která obsahuje množství nástrojů pro testování zabezpečení a průnikového testování, jako jsou například nástroje pro testování síťové bezpečnosti, pro získávání přístupu k cílovým systémům, pro odhalování zranitelností a další. Kali Linux je oblíbeným nástrojem mezi profesionálními bezpečnostními specialisty, etickými hackery a studenty, kteří se učí o bezpečnosti sítí a systémů.


Samozřejmě je toto prostředí pouštěno v Oracle VM VirtualBox.

%todo omáčka o kali 
\cite{kali_mainpage}

Linux je Linux a proto je v rámci kmenové distribuce jednoduché naistalovat vše, co je potřeba.
Výhoda Kali je však předpřipravenost mnoha nástrojů, které nemusí uživatel instalovat navíc.

%todo doplŇ omáčku o kali


Menší změna však nastala při 10 výročí této distribuce\cite{kali_purple}.
Vývojáři představili Kali Purple, kterou je možné vidět na obrázku~\ref{fig:kali_purple}.
\clfig{Kali_Purple_VirtualBox}{\linewidth}{Spuštěná Kali Purple ve virtuálním prostředí}{Vlastní}{fig:kali_purple}

Tato verze Kali Linux je více orientována na defenzivní testování oproti klasické ofenzivně zaměřené Kali.
Proto byl původní plán pozměněn a pro implementaci prostředí byla použita právě Kali Purple.
Zvědavost a možnost testování nové distribuce byly také faktory vedoucí k této změně.
S tímto rozhodnutím se však váže i menší problém.
Kali nabízí na svých stránkách ke stáhnutí mnoho různých verzí \textit{image}, mezi kterými je i specifická verze připravená pro VirtualBox.
Kali Purple je však zatím dostupná pouze v podobě klasického instalačního \textit{image}.
Prvotní příprava je proto o instalační krok ztížena.
To však není velký problém.

\nlparagraph{Caldera}
Po připravení operačního systému ve virtuálním prostředí je čas nainstalovat nástroj Mitre Caldera.
Při samotné instalaci Caldery nastal další problém.
Nejnovější verze Caldery v době psaní je 4.1.0 která vyšla 19.9.2022.
V době testování však tato verze Caldery nejde zkompilovat na nové verzi Kali Purple.
Tento fakt je vidět na obrázku~\ref{fig:caldera_error}.
%todo upravit
\clfig{Caldera_error_msg}{\linewidth}{Chyba kompilace Caldera frameworku}{Vlastní}{fig:caldera_error}


\noindent Tento problém vyplývá ze starších balíčků, které calder vyžaduje pro svoji funkčnost.
Je zřejmé, že nejnovější verze pip3 a python3 je již plně nepodporují.
Nabízí se tedy několik řešení, jak tento problém vyřešit.
Prvním a velmi líným řešením je oznámit problém a počkat na vydání nové verze.
Toto řešení zachovává stabilitu systému a frameworku, je to však na úkor času.
Autoři kaldery mají nejlepší znalosti a možnosti otestovat, zda změny v závislostech neovlivnili správnou funkčnost frameworku.
Z časových důvodů to však není pro tuto práci možné.
Dalším možnám řešením je změna verze pythonu pro celý systém.
To je však velmi drastický zásah do celého systému a mohl by vézt ke ztrátě stability aplikací nebo dokonce celého systému.
Realističtější možností je vytvořit virtualizaci pythonu a využívat nižší verzi pythonu pouze pro specifické aplikace, v tomto případě pro Calderu.
Caldera je však složitá aplikace, využívající nestandardní serverovou strukturu.
Není tak zajištěno, že při zkompilování pod určitým pythonem se aplikace nepokusí využívat systémovou vyšší verzi.
Posledním řešením je zkusit identifikovat problematické balíčky a najít, zda existují novější kompatibilní verze.
Problémem tohoto řešení je možná nefunkčnost aplikace v závislosti na tom, jak velký rozdíl je mezi verzemi balíčků.
Lze však očekávat, že novější balíčky mají zpětnou kompatibilitu, není však neomezená.

\nlparagraph{Výsledné řešení}
Po porovnání přístupů se jako nejlepší řešení jeví využití novějších verzí balíčků.
Virtualizace pythonu je druhé nejlepší řešení.
Zde je však větší šance problémů a tak slouží jako záloha v případě, že první řešení nebude fungovat.
Identifikace problémových balíčků je jednoduchá přímo ze zpětné vazby při kompilování, jak je možné vidět na obrázku~\ref{fig:caldera_error}.
Prvním problémovým balíčkem je aiohttp, který je ve verzi 3.8.1.
V repozitáři balíčků je možné najít nejnovější aiohttp ve verzi 3.8.4.
To je možné vidět na obrázku~\ref{fig:pypi_aiohttp}
\clfig{pypi_aiohttp}{\linewidth}{Nejnovější verze balíčku aiohttp v repozitáři Pypi}{Vlastní}{fig:pypi_aiohttp}

Po změně na tuto novou verzí byl identifikován další problémový balíček.
Je jím reportlab ve verzi 3.5.67, kde je opět možné nahradit novější verzi 3.6.12.
Následný pokus o zkompilování proběhl úspěšně.
V tuto chvíli vypadá soubor s požadovanými balíčky takto ~\ref{fig:new_setup}.
%todo remake, just the requirements
\clfig{new_setup}{\linewidth}{Nová podoba souboru requirements.txt}{Vlastní}{fig:new_setup}

Po spuštění serveru existuje propojení přes localhost:8888.
I přihlášení pomocí základního uživatele red s heslem admin proběhlo úspěšně a tak lze předpokládat, že caldera je funkční a připravena pro testování, viz ~\ref{fig:Caldera_running}.
%todo remake
\clfig{Caldera_running}{\linewidth}{Caldera framework po úvodním přihlášení}{Vlastní}{fig:Caldera_running}

\nlparagraph{Recon-ng}
Zajímavým nástrojem, který byl připraven ale nakonec nebyl využit je \textit{Recon-ng}.
Jedná se o open-source \ac{OSINT} nástroj v příkazové řádce.
Díky volbě Kali Purple jako testovacího prostředí je jeho instalace opravdu snadná.
Stačí v příkazové řádce vykonat příkaz \textbf{sudo apt-get install recon-ng}.
Zajímavějším a důležitějším krokem je však instalace modulů.
Po zapnutí nástroje příkazem \textbf{recon-ng} je možné instalovat jednotlivé moduly přes marketplace.
Všechny moduly je možné zobrazit příkazem \textbf{marketplace search}.
Vybrané moduly jsou nainstalovány příkazem \textbf{marketplace install \textit{jmeno\_modulu}}.
Při testování však byla zjištěna zastaralost a nefunkčnost důležitých modulů.
Také ovládání tohoto nástroje je zvláštní a po otestování bylo od použití tohoto nástroje v labech odstoupeno.
Recon-ng je totiž možné nahradit specializovanými nástroji a technikami, jako je například \textit{nmap}.


\nlparagraph{nmap}
tanto nástroj je
%todo add nmap


\subsection{Popis testované infrastruktory}
%todo opsat od honzíka

založeno na datech z nemocničního prostředí.
prvotní návrh je jednoduchý a reflektuje získaná data, viz obrázek ~\ref{fig:prvotni_navrh}.
\clfig{prvotni_navrh}{\linewidth}{Prvotní návrh testovaného prostředí}{Vlastní}{fig:prvotni_navrh}

Tento jednoduchý návrh byl posléze předělán do použitelného návrhu prostředí.
Je jasně vidět zachování základní myšlenky.
Tato základní myšlenka však byla rozvinuta do simulace reálného prostředí.
\clfig{ptModel}{\linewidth}{Návrh prostředí v Cisco Packet Tracer}{Vlastní}{fig:ptmodel}
Na návrhu je vidět segmentace,......
%todo omáčka o tom co je na návrhu
Posledním krokem je implementace na skutečných zařízeních.
Za tímto účelem bylo využito hned několik zařízení.
%todo popsat zařízení, co na nich je a čemu odpovídají v návrhu
%todo vypsat seznam použitých zařízení

Na simulačním serveru ve virtuálním prostředá běží dvě samostatné serverové implementace.
Jsou to \textit{Windows Server 2012 R2} a \textit{Ubuntu Server 20.04.4 Focal Fossa}.

\paragraph{}
Závěrem je nutnost otestování správné připojení všech komponentů.
Důležitým bodem je hlavně možnost komunikovat se servery ve virtuálních prostředích.
Proto bylo otestováno u každého zařízení postupně připojení sama na sebe, připojení na switch a router, připojení na ostatní prvky v daném VLAN a nakonec komunikace s prvky v ostatních VLAN\@.
Po úspěšném otestování všech zařízení je možné považovat  infrastrukturu za připravenou pro testovaní v labech.

\subsection{Testované scénáře}
%todo představení scénářu

\clfig{Mitre}{\linewidth}{Barevné označení jednotlivých scénářů}{Vlastní}{fig:mitre_colors}

přidat jsem identifikované vulnarability z navigátoru, u každého scénáře pak z navigáto přesně to, co je testované

\subsubsection{Scénář 1 - recon}
%todo
jak se dělá recon, popsat co používáme za nástroj, co to znamená, co to vyhodilo

\subsubsection{Scénář 2 - \textit{Discovery} a \textit{Elevate-privileges}}
Scénář 2 navazuje na scénář 1.
Snahou je simulovat možné kroky útočníka poté, co provedl sběr informací o cíli.
Cílem útočníka je tedy využít získaná data ve svůj prospěch a provést kompromitaci systému.
Jak již bylo zmíněno v teoretické části textu, jedním z nejpoužívanějších vektorů pro prvotní kompromitaci systému je \textit{phishing}.
Útočník využije již získaných dat ze scénáře 1 pro vytvoření \textit{phishingové kampaně}, jejímž cílem je kompromitovat zařízení.
Pro účely scénáře 2 uvažujeme, že se útočníkovi tímto vektorem povedlo získat prvotní vstup.
Je totiž těžké simulovat phishing v laboratoři.
Jeho založení na psychologii a zranitelnostech lidského chování lze sice jednoduše napodobit, nemá však velký vypovídající význam.
Pro účely testování tedy uvažujeme, že běžný uživatel klikl na podvodný email, který útočníkovi poskytl vzdálený přístup k jeho zařízení.
Důležité je, že se jedná o běžného uživatele.
V pozdějších částech tohoto labu je ukázáno, jaký je rozdíl v možnostech útočníka v případě, že by se jednalo o privilegovaného uživatele.
Tento scénář bude simulován na již popsané testovací infrastructure.
V roli útočníka bude působit Caldera, jakožto nástroj pro testování.
Za zmínku stojí fakt, že většina infrastruktury obsahuje nejnovější operační systémy.
Výjimkou jsou servery, kde lze očekávat dlouhodobě podporován starší verze.
Pozor však na fakt, že na všechna zařízení byly uplatněny nejnovější bezpečnostní aktualizace.
To znamená, že tato infrastruktura je proti útokům stejně odolná, jako nejlepší možná varianta skutečné infrastruktury.
Pokud však správce skutečné infrastruktury podcenil aktualizace zařízení, lze očekávat, že bude na útoky náchylnější.
Výsledkem je tedy nelichotivá komparace testovací a skutečné infrastruktury.
Pokud se útok povede na testovací infrastruktuře, zcela jistě ho bude možné provézt i na skutečné.
I nevydařený útok na testovacím prostředí má však šanci na skutečné infrastruktuře uspět.
Tento fakt pouze svědčí o tom, že je nutné aktualizovat zařízení kvůli bezpečnosti.


\nlparagraph{Příprava scénáře}
Pro simulaci scénáře je nutné připravit agenta v testovacím nástroji Caldera.
Tento agent pak simuluji kompromitování zařízení a provádí testování, které mu nastavíme.
V Caldeře je možné sledovat a vytvářet agenty v záložce agents, viz obrázek~\ref{fig:caldera_agents}.
%todo crop image
\clfig{lab/Agent_mainpage}{\linewidth}{Stránka pro ovládání agentů}{Vlastní}{fig:caldera_agents}

Agenta lze vytvořit stiskem tlačítka \textit{Deploy an agent}.
Po stisknutí je uživateli představen formulář pro bližší specifikaci agenta, viz obrázek~\ref{fig:agent_creation}.
V tomto formuláři je nutné nastavit platformu a kontaktní adresu Caldera serveru.
Vhodné je také změnit \textit{implant\_name}, což je název, pod kterým bude agent vidět na infikovaném stroji.
V rámci testování bylo použito jasně rozeznatelné jméno \textbf{caldera}.
Pro složitější testování, kde se snaží útočníci red teamu vyhnout detekci členy obrany v blue teamu by mohlo být zvoleno méně nápadné jméno, jako například \textbf{svchost}.
Na obrázku jsou pak také vidět příkazy, které je nutné spustit na simulovaném napadeném zařízení pro instalaci a nastavení agenta.
Existuje několik verzí příkazů, pro tuto práci jsou však aplikovatelné příkazu na obrázku~\ref{fig:agent_creation}, které jsou určené pro windows powershell.
Po provedení příkazů agent sám naváže komunikaci se serverem Caldera.
Agent navíc pravidelně ohlašuje svoje informace serveru, a to až do doby svého ukončení.
Caldera naopak o agentovi vede záznam a může mu posílat instrukce.

\clfig{lab/agent_creation}{\linewidth}{Formulář pro vytvoření agenta}{Vlastní}{fig:agent_creation}

Na obrázku~\ref{fig:caldera_agents} je možné vidět již vytvořeného agenta připraveného pro další testování.
Za povšimnutí stojí všechny údaje, které jsou s agentem spojené.
Základní údaje jsou \textit{id} a \textit{host}, které agenta jednoznačně identifikují.
\textit{Platform} identifikuje, na jaké platformě je agent spuštěn.
Nejdůležitější údaje jsou však \textit{group} a \textit{privilege}.
\textit{group} označuje pracovní skupino, do které agent patří.
To je důležité pro spouštění operací, kde právě pomocí \textit{group} určujeme, kteří agenti mají operace vykonávat.
\textit{privilege} určuje, jaká práva má agent na daném zařízení.
\textbf{User} znamená, že tento agent byl spuštěn běžným uživatelem a zdědil tak jeho základní práva.
Pokud by agenta spustil privilegovaný uživatel, v této kolonce by bylo označení \textbf{elevated}, jak je možné vidět na pozdějším obrázku~\ref{fig:dead_agent}.
Je také možné identifikovat, jak s caldera serverem agent komunikuje pomocí atributu \textit{contact}.
Poslední důležité údaje vypovídají o stavu agenta[\textit{status}] a informací o čase posledního kontaktu agenta se serverem[\textit{last seen}].
Samozřejmě existuje i podrobnější výpis přímo po rozkliknutí agenta, viz obrázek~\ref{fig:dead_agent}.
Za povšimnutí zde stojí informace, které mohou být využitelné pro útočníka.
Jsou jimi \textit{Host IP addresses, Architecture} a primárně \textit{Executors}.
Důležité je tlačítko \textit{Kill agent}, kterým se zastaví funkčnost agenta.
Černý křížek na hlavní stránce agentů, viz obrázek~\ref{fig:caldera_agents}, nezpůsobí ukončení agenta ale pouze ho odstraní se seznamu agentů.
Stále fungující agent se proto v tomto seznamu znovu objeví při jeho další komunikaci se serverem.

\clfig{lab/dead_agent}{\linewidth}{Detaily specifického agenta}{Vlastní}{fig:dead_agent}

\nlparagraph{Výběr chování při útoku - adversary}
Dalším důležitým krokem je příprava chování útočníka.
To je v Caldeře simulované pomocí takzvaných \textit{Adversaries}.
\textit{Adversary} je simulovaný útočník, kterému vybereme techniky, které bude v operaci provádět.
To je možné vidět na obrázku~\ref{fig:adversary_show_techniques}.
Jak již bylo zmíněno, Caldera je založena na Frameworku Mitre ARR\&CK\@.
Proto je možno u \textit{adversaries} vybírat techniky podle taktik z Mitre ARR\&CK\@.

%todo remake with create profile button and proper crop
\clfig{lab/adversary_show_techniques}{\linewidth}{Ukázka technik u simulovaného útočníka}{Vlastní}{fig:adversary_show_techniques}

\noindent
Nový \textit{adversary} je vytvořen pomocí tlačítka \textit{new profile}.
To otevře formulář pro vyplnění názvu a popisu tohoto profilu útočníka.
poté je nutné přidat techniky, které bude tento útočník provádět.
To lze udělat 2 způsoby.
Prvním je přidání  technik jiného profilu pomocí tlačítka \textit{Add adversary}.
Samozřejmostí je výběr technik, které lze z jiného profilu přidat.
Pokud tedy existuje profil, který z velké části odpovídá potřebám testování, toto je nejrychlejší volba jak bez úpravy původního profilu lze vytvořit nový.
Druhým způsobem přidávání technik je tlačítko add ability, kde přidáváme jednotlivé požadované techniky.

%todo make picture for add ability search
todo add picture\label{fig:ability_selection}
%\clfig{lab/ability_selection}{\linewidth}{Ukázka výběru technik}{Vlastní}{fig:ability_selection}

Jak je vidět na obrázku~\ref{fig:ability_selection}, vyhledávání technik lze provádět 2 způsoby.
Pokud je známo jméno techniky nebo alespoň přibližné zaměření, lze použít přímé vyhledávání technik.
Naopak pokud je vyžadováno využití určité taktiky, je možné vyhledávat selektivně podle nich.
Volba taktiky pak vede k volbě technik, které vedou na volbu sub-technik nebo specifických provedení dané techniky.

\nlparagraph{Adversary pro scénář 2}
Pro scénář 2 byli vyzkoušeni 2 hlavní profily útočníků, které byli pojmenováni \textit{Lab02} a \textit{Lab02v2}.
Pro přehlednost budou i operace pojmenované podle \textit{adversary}, který v nich figuruje.
Operace \textit{Lab02} je zaměřena na rozsáhlé testování testování.
Předpokládáme útočníka, který nezná vnitřní prostředí a jeho cílem je získat co nejvíce informací a vyzkoušet základní taktiky, které jsou pro něj přínosné.
\textit{Adversary} pro tuto operaci obsahuje 74 technik.
Útočník v operaci \textit{Lab02v2} využije znalosti z předchozí operace a pokusí se dosáhnout specifických cílů.
V tomto případě se jedná specificky o získání privilegií administrátora a vypnutí monitorování.
Tento útočník proto obsahuje 31 technik zaměřených právě k tomuto záměru.


\nlparagraph{Spuštění operace}
%\clfig{lab/operation}{\linewidth}{Ukázka správy operací}{Vlastní}{fig:operation}
Finálním krokem testování je spuštění operace.
K tomuto účelu v Caldeře slouží záložka \textit{Operations}, viz obrázek~\ref{fig:operation}.
Zde je možné spouštět nebo vytvářet nové operace.
Zároven tato záložka slouží pro správu operací, které již byly uskutečněny.
Zachovávají se zde informace o průběhu operace a případných výstupech z daných technik.
Jelikož již bylo připraveno vše pro správnou činnost operace, je načase kliknout na tlačítko \textit{Create operation}.
Tím je vyvolán formulář pro tvorbu nové operace, viz obrázek~\ref{fig:operation_creation}.
Je zde několik důležitých nastavení.
Jméno operace a nastavení požadovaného \textit{adversary} je přímočaré.
\textit{Fact source} je zajímavější.
Je to předpřipravené poznatky, například o testovaném zařízení, které lze přímo zadat nebo použít zjištění z předchozích operací.
V rozšířené sekci se pak nachází složitější nastavení.
Jsou zde nastavení pro cílovou skupinu[\textit{Group}], tedy určení, kteří agenti mají provádět úkony
\textit{Planner} určuje, jak budou operace prováděny.
základem je \textbf{atomic}, který posílá jednotlivé příkazy jeden po druhém ve stejném pořadí, v jakém se nachází u \textit{adversary}.
Lze však vytvořit vlastní \textit{planner} s rozdílným chováním\cite{mitre_caldera_docs}.
V neposlední řadě se zne nachází přepínače pro řízení chodu operací a možnosti zakódovaní a krytí operace.
%todo crop
\clfig{lab/operation_creation}{\linewidth}{Ukázka tvorby operace}{Vlastní}{fig:operation_creation}
Pro účely této práce jsou všechny operace nastaveny na automatické spuštění při vytvoření a také automatické uzavření a kolekci dat.
Automatické spuštění je zřejmé, již máme připraveny všechny stavební bloky pro vykonání operace a tak není třeba nic dalšího připravovat a čekat.
Automatické uzavření a kolekce vyplývá z faktu, že se jedná o kompletní operace, nechceme v běhu operace přidávat další kroky ani přistupovat k napadenému zařízení na přímo a vykonávat vlastní příkazy.
V rámci automatizace je tedy výhodnější zvolit automatické uzavření a kolekci, protože není nutné hlídat zda jsme již provedly všechny požadované kroky operace a je nutné zadat příkaz ke kolekci.
Z pohledu efektivity to také uvolňuje čas testovatele, který může během průběhu jedné operace vytvářet jinou nebo zkoumat data z jiné operace.
Pro referenci, operace může běžet i několik hodin a pokud tedy není dozor potřeba, je dobré se mu vyhnout.


\nlparagraph{Lab02}


Cílem simulovaného útočníka je pokusit se získat pro něj zajímavé informace.
Informace na kterém se v tomto kontextu zaměřujeme jsou data z prohlížečů jako cookies, záložky a historie prohlížení.
Vzhled operace proto bude vypadat tak, jak je ukázáno na obrázku~\ref{fig:lab02}.
Z ukázky je zřejmé, že ne všechny chtěná data se podařilo nalezt, je jich však dostatek pro další využití útočníkem.

%todo vypsat zajímavá data z obrázku

\clfig{lab/lab02}{\linewidth}{Ukázka probíhající operace}{Vlastní}{fig:lab02}

Také data o samotné zařízení jsou pro útočníka zajímavá v kontextu hledání využitelných zranitelností.


Důležitým zjištěním této operace je přítomnost firewallu a antiviru na testovaném zařízení.
Výstupy zkoumající tyto fakty je možné vidět na obrázcích~\ref{fig:antivirus_discovery,fig:firewall_discovery}.

\clfig{lab/antivirus_discovery}{\linewidth}{Nalezené informace o antiviry na testovaném zařízení}{Vlastní}{fig:antivirus_discovery}
\clfig{lab/firewall_discovery}{\linewidth}{Nalezené informace o firewall na testovaném zařízení}{Vlastní}{fig:firewall_discovery}


%todo
plošné zkoušení možností

\nlparagraph{Lab02v2}
Tato operace a adversary využívají již zjištěných dat k upřesnění specifických cílů.
Simulujeme zde situaci, kdy útočník získal základní data o napadeném zařízení.
Jeho cílem je ted nejen získat vyšší práva nad tímto zařízením
Prvním krokem je tak zlepšení šancí na dosažení těchto cílů.
Za tímto účelem se simulovaný útočník pokusí vypnout antivirová opatření, na která narazil v předchozí operaci, viz obrázek~\ref{fig:antivirus_discovery}.
To však není zcela úspěšné, jak již bylo psáno nacházíme se na nové verzi Windows, která je adekvátně aktualizovaná.
Nemůže tak být překvapením, že se tato taktika nezdařila.
Důležité je však poznamenat, že v systému Windows ale také nevyvolala v tomto kroku operace žádné hlášení.
Hlášení nastala, až kdy se simulovaný útočník pokoušel získat administrátorská práva.
V rámci testování se tato práva snažil získat všemi možnostmi, které Caldera nabízí.
Tento fakt a vyvolané poplašné hlášení je možné vidět na obrázcích~\ref{fig:privilege_escalation},\ref{fig:all_blocked_threats} a \ref{fig:specific_threat}.

%todo remake, show some antivirus disablin and then this, its in the other operation
\clfig{lab/privilege_escalation}{\linewidth}{Probíhající operace zaměřená na získání administrátorských privilegií}{Vlastní}{fig:privilege_escalation}
\clfig{lab/all_blocked_threats}{\linewidth}{Záznamy o vyvolaných hrozbách}{Vlastní}{fig:all_blocked_threats}
\clfig{lab/specific_threat}{\linewidth}{Specifika náhodně vybrané hrozby}{Vlastní}{fig:specific_threat}

Jak je vidět z obrázků, všechny pokusy o získání administrátorských práv byly zastaveny a oznámeny uživateli.
Je tedy zřejmé, že testování systému opravu provádí nebezpečné operace o kterých je nutné uživatele informovat.
Již při vytváření operace bylo jasné, že šance úspěchu předchozích operací je malá.
proto jejich neúspěch není překvapením ale očekávaným a správným výsledkem.
Naopak by bylo nemilým překvapením, kdyby se nám takto jednoduchým způsobem povedlo administrátorská práva získat.
Poslední částí této operace jsou pokusy o získání dalších důležitých dat, která by útočníkovi mohla pomoci získat administrátorský přístup.
Příkladem je například politika hesel, která existuje na daném zařízení.
Jak je patrné na obrázku~\ref{fig:show_password_policy}, Caldera si plně nerozumí s českou lokalizací systému.
To pouze znamená, že není možné sběr dat plně zautomatizovat, nejdůležitější poznatky lze stále přečíst, i když se zvýšeným úsilím.

%todo crop
\clfig{lab/show_password_policy}{\linewidth}{Nalezená politika hesel}{Vlastní}{fig:show_password_policy}

Poslední technikou v této operaci, která stojí za zvláštní zmínku, je zobrazení všech procesů daného uživatele.
Jak je vidět na obrázku~\ref{fig:show_user_processes}, pro útočníka je možné zjistit všechny procesy daného uživatele.
To je důležité hned z několika důvodů.
Znalost procesů dovoluje útočníkovi napodobit jména často používaných procesů a tak je před uživatelem chovat.
Ještě důležitější je pro útočníka tato znalost z důvodu hledání slabin.
Znalost procesů omezuji množinu programů, které musí útočník zkontrolovat pro využitelné slabiny.
Navíc nemusí řešit dodatečnou instalaci nástrojů nebo hledat slabiny přímo v operačním systému, pokud může využít slabin již nainstalovaných programů se stejným výsledkem.
Tato možnost není uplatnitelná vždy, ale je dobré mít ji na paměti.
Posledním důvodem, proč procesu uživatele útočníka zajímají jsou data, která z těchto procesů může útočník vytěžit.
Pokud narazí na proces, který ho zajímá, může na něj zaměřit další fáze útoku.
Například už jen zjištění, který prohlížeč uživatel preferuje zjednodušuje následující útoky na data.
Nebo fakt, že uživatel využívá nějaké cloudové uložiště, jak je například vidět na obrázku~\ref{fig:show_user_processes}.
%todo crop
\clfig{lab/show_user_processes}{\linewidth}{Ukázka všech procesů uživatele}{Vlastní}{fig:show_user_processes}


\nlparagraph{Změny s privilegovaným uživatelem}
%todo add more or pictures?
V rámci zvědavosti byly stejné operace, tedy \textit{Lab02} a \textit{Lab02v2}, pouštěny na jiném zařízení v infrastruktuře tentokrát s privilegovaným přístupem.
Získaná data byla až na pár operací stejná.
To potvrzuje domněnku robustního systému, kde celkový stabilita a dostatečné zabezpečení v podobě antiviru odbouralo alespoň část hrozby.
Zajímavá jsou však data z operace \textit{Lab02v2}.
Operace \textit{Lab02} byla primárně pro zjištění dat, proto tam nejsou značné odchylky.
\textit{Lab02v2} byl na získání vyšších uživatelských práv, což popravdě nedává s administrátorským účtem smysl.
zajímavé je, že se nám podařilo částečně vyřadit fungování antivirového programu.
Další překvapivé zjištění také bylo, že místo selhání všech hrozeb pro zisk privilegií se jedna technika vydařila.
Tento poznatek nemá velký smysl, ale je to zajímavé a úsměvné zjištění.
%todo add picture with succesfull technique


\subsubsection{Scénář 3 - discovery, impact a worm}
kde lab2 zaměřen na jedno zařízení, lab 3 testuje sít -> moc robustní aby jsme tam dělali velké věci
%todo
specifičtější testování na discovery a worm, který teda nefunguje ale to jen protože to máme moc dobře udělané

\subsection{Celkové zhodnocení výsledků}\label{subsec:celkove-zhodnoceni-vysledku}
%todo


\section{Závěry a doporučení}\label{sec:zavery-a-doporuceni}

% TODO WRITER: text

Kritická diskuze nad výsledky, ke kterým autor dospěl (soulad výsledků  literaturou či předpoklady;
výsledky a okolnosti, které zvláště ovlivnily předkládanou práci atd.).
Je vhodné naznačit i případné další
(popř. alternativní) možnosti zkoumání dané problematiky a otevřené problémy pro další studium.




% todo del - this is example and testing section

Vlastní řešení dokládá student zpravidla v několika kapitolách.
Podle charakteru práce musí student uvážit, zda informace
netextové povahy (data, tabulky, obrázky atd.) bude uvádět přímo v textu, nebo je zařadí až za celou práci ve formě příloh, či bude kombinovat oba způsoby.
Více podrobností viz Metodické pokyny pro vypracování bakalářských a diplomových prací (zveřejňované formou výnosů děkana)
a v kurzu MES – Metodologický seminář.

	\subsection{Podkapitola}

	Text podkapitoly.

	Následuje ukázka nějakého seznamu:
	\begin{itemize}
		\item fotografie/avatar,
		\item kategorizační štítky,
		\item popisek.
	\end{itemize}

		\subsubsection{Podpodkapitola}

		Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus sit amet ornare diam, id consequat diam.

			\nlparagraph{Paragraf}

			\noindent Ukázka prvního odstavce v paragrafu. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus sit amet ornare diam, id consequat diam.



			Použití obrázku je jednoduché, zadáme název souboru, šířku, popisek a zdroj:\cntcapfigure{rovnovaha_paka}{8cm}{Páka rovnováhy vzhledu.}
			V případně, že autor je i autor obrázku:

			\cntcapfigure{uhk}{\linewidth}{Toto je UHK.}{[autor]}

			Blok kódu může vypadat takto:

			\begin{codeblock}
				\begin{verbatim}
@Mapper
public interface AccountDao {
  @Select({
    "select *",
    "from " + Account.TABLE_NAME,
    "where email = #{email}"
  })
  Optional<Account> findByEmail(String email);
}
				\end{verbatim}
				\captionsource{Ukázka bloku kódu.}{[autor]}
			\end{codeblock}

			Tabulka zas může vypadat takto:

			\begin{table}[hbt!]
				\captionsource{Ukázková tabulka.}{[autor]}
				\centering
				\begin{tabular}{| l | r | r | r | }
					\hline
					&        psnr &      ssim &      doba  \\
					model &       (db)    &           & gen. (s) \\
					\hline
					bik. int. & 28.3155 & 0.8566 & 0.0322 \\
					nn1000    & 30.1461 & 0.9043 & 0.8109 \\
					nn1001    & 30.0324 & 0.9023 & 0.7486 \\
					nn1002    & \textbf{30.1886} & \textbf{0.9046} & 1.1731 \\
					nn1003    & 30.0390 & 0.9030 & 1.1320 \\
					nn1004    & 24.9772 & 0.7172 & 4.4367 \\
					nn1005    & 26.1629 & 0.8004 & 4.0475 \\
					nn1006    & 27.9129 & 0.8438 & 4.0683 \\
					nn1007    & 27.5834 & 0.8360 & 4.2082 \\
					\hline
				\end{tabular}
			\end{table}

			\newpage

			Další text
